<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡æœ¬åŠ å¯†æ··æ·†å·¥å…·</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/crypto-js/4.2.0/components/mode-ecb.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/crypto-js/4.2.0/components/pad-zeropadding.min.js"></script>
    <style>
        * {margin: 0;padding: 0;box-sizing: border-box;transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;}
        :root {--bg-color: #f8fafc;--text-color: #1e293b;--input-bg: #ffffff;--input-border: #e2e8f0;--input-focus: #3b82f6;--button-primary: #3b82f6;--button-primary-hover: #2563eb;--button-secondary: #64748b;--button-secondary-hover: #475569;--card-bg: #ffffff;--card-shadow: 0 1px 3px rgba(0,0,0,0.1);--tip-success-bg: #ecfdf5;--tip-success-text: #065f46;--tip-error-bg: #fef2f2;--tip-error-text: #991b1b;--select-bg: #ffffff;--select-border: #e2e8f0;--file-input-bg: #f1f5f9;--tag-active: #3b82f6;--tag-default: #e2e8f0;--tag-text-active: #fff;--tag-text: #1e293b;--modal-mask: rgba(0,0,0,0.5);--modal-bg: #fff;--modal-border: #e2e8f0;}
        :root.dark {--bg-color: #0f172a;--text-color: #f1f5f9;--input-bg: #1e293b;--input-border: #334155;--input-focus: #60a5fa;--button-primary: #3b82f6;--button-primary-hover: #60a5fa;--button-secondary: #94a3b8;--button-secondary-hover: #cbd5e1;--card-bg: #1e293b;--card-shadow: 0 1px 3px rgba(0,0,0,0.3);--tip-success-bg: #0f766e;--tip-success-text: #ccff33;--tip-error-bg: #7f1d1d;--tip-error-text: #fecdd3;--select-bg: #1e293b;--select-border: #334155;--file-input-bg: #273449;--tag-active: #3b82f6;--tag-default: #334155;--tag-text-active: #fff;--tag-text: #f1f5f9;--modal-mask: rgba(0,0,0,0.7);--modal-bg: #1e293b;--modal-border: #334155;}
        body {max-width: 900px;margin: 40px auto;padding: 0 20px;font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;background-color: var(--bg-color);color: var(--text-color);line-height: 1.6;}
        .header {display: flex;justify-content: space-between;align-items: center;margin-bottom: 30px;flex-wrap: wrap;gap: 15px;}
        .title {font-size: 24px;font-weight: 600;color: var(--button-primary);}
        .theme-toggle, .help-btn, .lang-toggle {padding: 8px 16px;border: none;border-radius: 6px;background: var(--button-secondary);color: white;cursor: pointer;font-size: 14px;}
        .theme-toggle:hover, .help-btn:hover, .lang-toggle:hover {background: var(--button-secondary-hover);}
        .input-group {margin-bottom: 25px;padding: 20px;background-color: var(--card-bg);border-radius: 10px;box-shadow: var(--card-shadow);}
        .input-group label {display: block;margin-bottom: 10px;font-weight: 500;font-size: 15px;}
        .input-group input,.input-group textarea,.input-group select {width: 100%;padding: 12px 15px;border: 2px solid var(--input-border);border-radius: 8px;font-size: 16px;resize: vertical;background-color: var(--input-bg);color: var(--text-color);font-family: inherit;-webkit-tap-highlight-color: transparent;}
        .input-group input:focus,.input-group textarea:focus,.input-group select:focus {outline: none;border-color: var(--input-focus);}
        .input-group textarea {min-height: 150px;}
        .encrypt-type {margin-bottom: 20px;}
        .custom-rule {display: flex;gap: 15px;flex-wrap: wrap;margin: 15px 0;}
        .custom-rule > div {flex: 1;min-width: 200px;}
        .file-upload {margin: 15px 0;}
        .file-input {display: none;}
        .file-btn {padding: 8px 16px;background: var(--file-input-bg);border: 1px solid var(--input-border);border-radius: 6px;color: var(--text-color);cursor: pointer;font-size: 14px;}
        .file-btn:hover {background: var(--input-bg);}
        .button-group {margin: 25px 0;display: flex;gap: 12px;flex-wrap: wrap;}
        .button-group button {padding: 12px 24px;border: none;border-radius: 8px;background: var(--button-primary);color: white;font-size: 16px;cursor: pointer;transition: all 0.2s ease;font-weight: 500;-webkit-tap-highlight-color: transparent;}
        .button-group button:hover {background: var(--button-primary-hover);transform: translateY(-1px);}
        .button-group .secondary-btn {background: var(--button-secondary);}
        .button-group .secondary-btn:hover {background: var(--button-secondary-hover);}
        .result-btn-group {margin-top: 10px;display: flex;gap: 12px;flex-wrap: wrap;}
        .result-btn {padding: 10px 20px;font-size: 15px;border: none;border-radius: 8px;color: white;cursor: pointer;transition: all 0.2s ease;-webkit-tap-highlight-color: transparent;}
        .copy-btn {background: var(--button-secondary);}
        .copy-btn:hover {background: var(--button-secondary-hover);}
        .export-btn {background: #10b981;}
        .export-btn:hover {background: #059669;}
        .copy-tip {position: fixed;top: 20px;right: 20px;padding: 12px 24px;border-radius: 8px;opacity: 0;visibility: hidden;transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;z-index: 999;transform: translateY(-10px);font-weight: 500;}
        .copy-tip.success {background-color: var(--tip-success-bg);color: var(--tip-success-text);}
        .copy-tip.error {background-color: var(--tip-error-bg);color: var(--tip-error-text);}
        .copy-tip.show {opacity: 1;visibility: visible;transform: translateY(0);}
        .desc {font-size: 14px;color: var(--text-color);opacity: 0.8;margin-top: 5px;margin-bottom: 15px;line-height: 1.5;}
        .warning {color: #f59e0b;opacity: 1;}
        .encrypt-filter {display: flex;gap: 8px;flex-wrap: wrap;margin-bottom: 12px;align-items: center;}
        .filter-tag {padding: 6px 12px;border-radius: 20px;font-size: 13px;cursor: pointer;border: none;background: var(--tag-default);color: var(--tag-text);transition: all 0.2s ease;-webkit-tap-highlight-color: transparent;}
        .filter-tag.active {background: var(--tag-active);color: var(--tag-text-active);font-weight: 500;}
        .filter-tag:hover {opacity: 0.9;}
        /* å¼¹çª—ä¼˜åŒ–ï¼šæ‰‹æœºç«¯æ»šåŠ¨ä¸æ»‘ï¼ŒåŠ å…¼å®¹å±æ€§ */
        .help-modal {position: fixed;top: 0;left: 0;width: 100%;height: 100%;z-index: 9999;display: none;}
        .modal-mask {width: 100%;height: 100%;background: var(--modal-mask);}
        .modal-content {position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);width: 90%;max-width: 800px;max-height: 85vh;background: var(--modal-bg);border: 1px solid var(--modal-border);border-radius: 10px;padding: 24px;overflow-y: auto;/* å…¼å®¹æ€§æ»šåŠ¨ä¼˜åŒ– */-webkit-overflow-scrolling: touch;scroll-behavior: smooth;}
        .modal-close {position: sticky;top: 0;left: 100%;transform: translateX(-100%);width: 32px;height: 32px;border-radius: 50%;border: none;background: var(--button-secondary);color: white;cursor: pointer;font-size: 16px;display: flex;align-items: center;justify-content: center;margin-bottom: 16px;-webkit-tap-highlight-color: transparent;}
        .modal-close:hover {background: var(--button-secondary-hover);}
        .modal-title {font-size: 20px;font-weight: 600;color: var(--button-primary);margin-bottom: 16px;padding-bottom: 8px;border-bottom: 1px solid var(--modal-border);}
        .modal-section {margin-bottom: 20px;}
        .modal-section h3 {font-size: 16px;font-weight: 600;margin: 12px 0 8px;}
        .modal-section p, .modal-section li {font-size: 14px;line-height: 1.7;margin-bottom: 6px;}
        .modal-section ul {padding-left: 20px;margin-bottom: 6px;}
        .modal-tip {color: var(--button-primary);font-weight: 500;}
    </style>
</head>
<body>
    <div class="header">
        <div class="title" id="toolTitle">æ–‡æœ¬åŠ å¯†æ··æ·†å·¥å…·</div>
        <div style="display: flex;gap: 10px;align-items: center;">
            <button class="help-btn" id="helpBtn">ä½¿ç”¨è¯´æ˜</button>
            <!-- æ–°å¢ï¼šä¸­è‹±æ–‡åˆ‡æ¢æŒ‰é’® -->
            <button class="lang-toggle" id="langToggle">åˆ‡æ¢è‹±æ–‡</button>
            <button class="theme-toggle" id="themeToggle">åˆ‡æ¢æ·±è‰²æ¨¡å¼</button>
        </div>
    </div>

    <div class="input-group">
        <label for="encryptType" id="encryptTypeLabel">åŠ å¯†/è§£å¯†æ–¹å¼ï¼ˆå…±10ç§ï¼‰ï¼š</label>
        <div class="encrypt-filter">
            <button class="filter-tag active" data-type="all" id="filterAll">å…¨éƒ¨</button>
            <button class="filter-tag" data-type="high-safety" id="filterHighSafety">é«˜å®‰å…¨ç±»</button>
            <button class="filter-tag" data-type="light-mix" id="filterLightMix">è½»é‡æ··æ·†ç±»</button>
            <button class="filter-tag" data-type="encode" id="filterEncode">ç¼–ç ä¼ è¾“ç±»</button>
            <button class="filter-tag" data-type="custom" id="filterCustom">è‡ªå®šä¹‰ç±»</button>
        </div>
        <select id="encryptType" class="encrypt-type">
            <option value="aes" data-cate="high-safety" data-lang-zh="AESå¯¹ç§°åŠ å¯†ï¼ˆé«˜å®‰å…¨ï¼Œå›½é™…æ ‡å‡†ï¼‰" data-lang-en="AES Symmetric Encryption (High Security, International Standard)">AESå¯¹ç§°åŠ å¯†ï¼ˆé«˜å®‰å…¨ï¼Œå›½é™…æ ‡å‡†ï¼‰</option>
            <option value="sm4" data-cate="high-safety" data-lang-zh="SM4å›½å¯†åŠ å¯†ï¼ˆå•†ç”¨åˆè§„ï¼Œå›½å†…æ¨èï¼‰" data-lang-en="SM4 National Encryption (Commercial Compliance, Recommended in China)">SM4å›½å¯†åŠ å¯†ï¼ˆå•†ç”¨åˆè§„ï¼Œå›½å†…æ¨èï¼‰</option>
            <option value="rc4" data-cate="high-safety" data-lang-zh="RC4æµåŠ å¯†ï¼ˆå¹³è¡¡å®‰å…¨ä¸é€Ÿåº¦ï¼‰" data-lang-en="RC4 Stream Encryption (Balance Security and Speed)">RC4æµåŠ å¯†ï¼ˆå¹³è¡¡å®‰å…¨ä¸é€Ÿåº¦ï¼‰</option>
            <option value="xor" data-cate="light-mix" data-lang-zh="å¼‚æˆ–åŠ å¯†ï¼ˆæç®€å¿«é€Ÿï¼Œè½»é‡æ··æ·†ï¼‰" data-lang-en="XOR Encryption (Ultra Fast, Light Obfuscation)">å¼‚æˆ–åŠ å¯†ï¼ˆæç®€å¿«é€Ÿï¼Œè½»é‡æ··æ·†ï¼‰</option>
            <option value="caesarPlus" data-cate="light-mix" data-lang-zh="å‡¯æ’’å¢å¼ºç‰ˆï¼ˆå…¼å®¹ä¸­æ–‡ï¼Œçµæ´»åç§»ï¼‰" data-lang-en="Caesar Plus (Support Chinese, Flexible Offset)">å‡¯æ’’å¢å¼ºç‰ˆï¼ˆå…¼å®¹ä¸­æ–‡ï¼Œçµæ´»åç§»ï¼‰</option>
            <option value="charMove" data-cate="light-mix" data-lang-zh="å­—ç¬¦ç§»ä½æ··æ·†ï¼ˆè‡ªå®šä¹‰æ­¥æ•°ï¼Œæ˜“æ“ä½œï¼‰" data-lang-en="Character Shift Obfuscation (Custom Steps, Easy to Use)">å­—ç¬¦ç§»ä½æ··æ·†ï¼ˆè‡ªå®šä¹‰æ­¥æ•°ï¼Œæ˜“æ“ä½œï¼‰</option>
            <option value="base91" data-cate="encode" data-lang-zh="Base91ç¼–ç ï¼ˆé«˜å‹ç¼©æ¯”ï¼Œæ··æ·†æ€§å¼ºï¼‰" data-lang-en="Base91 Encoding (High Compression, Strong Obfuscation)">Base91ç¼–ç ï¼ˆé«˜å‹ç¼©æ¯”ï¼Œæ··æ·†æ€§å¼ºï¼‰</option>
            <option value="base64" data-cate="encode" data-lang-zh="Base64ç¼–ç ï¼ˆé€šç”¨å…¼å®¹ï¼Œä¼ è¾“é¦–é€‰ï¼‰" data-lang-en="Base64 Encoding (Universal Compatibility, First Choice for Transmission)">Base64ç¼–ç ï¼ˆé€šç”¨å…¼å®¹ï¼Œä¼ è¾“é¦–é€‰ï¼‰</option>
            <option value="base32" data-cate="encode" data-lang-zh="Base32ç¼–ç ï¼ˆä½è¾¨è¯†åº¦ï¼Œéšè”½æ€§å¥½ï¼‰" data-lang-en="Base32 Encoding (Low Recognition, Good Concealment)">Base32ç¼–ç ï¼ˆä½è¾¨è¯†åº¦ï¼Œéšè”½æ€§å¥½ï¼‰</option>
            <option value="customMix" data-cate="custom" data-lang-zh="è‡ªå®šä¹‰è§„åˆ™æ··æ·†ï¼ˆä¸ªæ€§åŒ–é…ç½®ï¼‰" data-lang-en="Custom Rule Obfuscation (Personalized Configuration)">è‡ªå®šä¹‰è§„åˆ™æ··æ·†ï¼ˆä¸ªæ€§åŒ–é…ç½®ï¼‰</option>
        </select>
        <div class="desc" id="encryptDesc">
            ğŸ“Œ é«˜å®‰å…¨ç±»ï¼šAES/SM4éœ€16ä½å¯†é’¥ï½œè½»é‡ç±»ï¼šä»»æ„å¯†é’¥ï¼Œå¿«é€Ÿæ··æ·†<br>
            ğŸ“Œ ç¼–ç ç±»ï¼šæ— å¯†é’¥ï¼Œæ–¹ä¾¿ä¼ è¾“ï½œè‡ªå®šä¹‰ç±»ï¼šåç§»é‡+æ··æ·†å­—ç¬¦éœ€ä¸€è‡´
        </div>

        <label for="aesKey" id="keyLabel">AES/SM4/RC4/å¼‚æˆ–/å‡¯æ’’å¢å¼º/ç§»ä½ å¯†é’¥ï¼ˆSM4å¿…å¡«16ä½ï¼Œå…¶ä½™ä»»æ„ï¼‰ï¼š</label>
        <input type="text" id="aesKey" placeholder="SM4å›ºå®š16ä½ï¼Œå¦‚abcdef1234567890" id="keyPlaceholder">
        <div class="desc warning" id="keyWarning">âš ï¸ å¯¹ç§°åŠ å¯†å¯†é’¥ä¸¢å¤±æ— æ³•è§£å¯†ï¼Œå›½å¯†SM4å¯†é’¥å¿…é¡»16ä½ï¼</div>

        <div class="custom-rule">
            <div>
                <label for="mixOffset" id="offsetLabel">åç§»/ç§»ä½æ­¥æ•°ï¼ˆå‡¯æ’’å¢å¼º/ç§»ä½/è‡ªå®šä¹‰æ··æ·†ç”¨ï¼Œ1-50ï¼‰ï¼š</label>
                <input type="number" id="mixOffset" value="5" min="1" max="50">
            </div>
            <div>
                <label for="mixChars" id="mixCharsLabel">æ··æ·†æ’å…¥å­—ç¬¦ï¼ˆä»…è‡ªå®šä¹‰æ··æ·†ç”¨ï¼‰ï¼š</label>
                <input type="text" id="mixChars" value="â˜…â– â—â–²â—†" placeholder="å¦‚ï¼šâ˜…â– â—â–²â—†ï¼ˆè‡ªå®šä¹‰ç‰¹æ®Šå­—ç¬¦ï¼‰" id="mixCharsPlaceholder">
            </div>
        </div>

        <div class="file-upload">
            <label id="fileUploadLabel">æ‰¹é‡å¯¼å…¥æ–‡æœ¬ï¼ˆæ”¯æŒ.txtæ–‡ä»¶ï¼‰ï¼š</label>
            <input type="file" id="fileInput" class="file-input" accept=".txt">
            <label for="fileInput" class="file-btn" id="fileBtn">é€‰æ‹©æ–‡ä»¶</label>
            <div class="desc" id="fileDesc">å¯¼å…¥åæ–‡æœ¬ä¼šè‡ªåŠ¨å¡«å……åˆ°åŸå§‹æ–‡æœ¬æ¡†ä¸­</div>
        </div>
    </div>

    <div class="input-group">
        <label for="originText" id="originTextLabel">åŸå§‹æ–‡æœ¬ï¼š</label>
        <textarea id="originText" placeholder="è¾“å…¥/å¯¼å…¥è¦åŠ å¯†/è§£å¯†çš„æ–‡æœ¬ï¼ˆæ”¯æŒæ±‰å­—ã€å­—æ¯ã€æ•°å­—ç­‰ï¼‰..." id="originTextPlaceholder"></textarea>
    </div>
    <div class="button-group">
        <button onclick="encryptText()" id="encryptBtn">åŠ å¯†/æ··æ·†</button>
        <button onclick="decryptText()" id="decryptBtn">è§£å¯†/è¿˜åŸ</button>
        <button class="secondary-btn" onclick="clearAll()" id="clearBtn">æ¸…ç©ºå†…å®¹</button>
    </div>
    <div class="input-group">
        <label for="resultText" id="resultTextLabel">å¤„ç†ç»“æœï¼š</label>
        <textarea id="resultText" placeholder="å¤„ç†åçš„ç»“æœ..." readonly id="resultTextPlaceholder"></textarea>
        <div class="result-btn-group">
            <button class="result-btn copy-btn" onclick="copyResult()" id="copyBtn">å¤åˆ¶</button>
            <button class="result-btn export-btn" onclick="exportResult()" id="exportBtn">å¯¼å‡ºä¸ºTXT</button>
        </div>
    </div>
    <div class="copy-tip" id="copyTip">å¤åˆ¶æˆåŠŸï¼</div>

    <div class="help-modal" id="helpModal">
        <div class="modal-mask" id="modalMask"></div>
        <div class="modal-content">
            <button class="modal-close" id="modalClose">Ã—</button>
            <div class="modal-title" id="modalTitle">æ–‡æœ¬åŠ å¯†æ··æ·†å·¥å…· ä½¿ç”¨è¯´æ˜ä¹¦</div>
            <div class="modal-section">
                <h3 id="modalSection1Title">ä¸€ã€ å·¥å…·åŸºç¡€ä¿¡æ¯</h3>
                <p id="modalSection1P1">âœ… æ ¸å¿ƒåŠŸèƒ½ï¼š10ç§æ–‡æœ¬åŠ å¯†/è§£å¯†/æ··æ·†/ç¼–ç ï¼Œå…¼å®¹æ±‰å­—ã€å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šç¬¦å·</p>
                <p id="modalSection1P2">âœ… è¿è¡Œæ–¹å¼ï¼šçº¯å‰ç«¯æœ¬åœ°å¤„ç†ï¼Œæ•°æ®ä¸ä¸Šä¼ ï¼Œæ— æ³„éœ²é£é™©</p>
                <p id="modalSection1P3">âœ… é™„åŠ åŠŸèƒ½ï¼šTXTå¯¼å…¥å¯¼å‡ºã€ä¸€é”®å¤åˆ¶ã€æ·±è‰²æ¨¡å¼ã€åˆ†ç±»ç­›é€‰ã€å†…ç½®è¯´æ˜ä¹¦</p>
                <p id="modalSection1P4">âœ… é€‚ç”¨è®¾å¤‡ï¼šç”µè„‘/æ‰‹æœºæµè§ˆå™¨é€šç”¨ï¼Œéƒ¨ç½²åå¯è·¨è®¾å¤‡è®¿é—®</p>
            </div>
            <div class="modal-section">
                <h3 id="modalSection2Title">äºŒã€ 3æ­¥å¿«é€Ÿä¸Šæ‰‹ï¼ˆæ–°æ‰‹å¿…çœ‹ï¼‰</h3>
                <p id="modalSection2P1">1.  é€‰æ–¹å¼ï¼šç‚¹é¡¶éƒ¨ç­›é€‰æ ‡ç­¾ï¼ˆæ¨èï¼‰æˆ–ä¸‹æ‹‰æ¡†ï¼Œå¿«é€ŸåŒ¹é…ä½¿ç”¨åœºæ™¯</p>
                <p id="modalSection2P2">2.  å¡«å‚æ•°ï¼šæŒ‰éœ€å¡«å¯†é’¥/æ­¥æ•°/æ··æ·†å­—ç¬¦ï¼Œç¼–ç ç±»æ— éœ€å¡«ä»»ä½•å‚æ•°</p>
                <p id="modalSection2P3">3.  å‡ºç»“æœï¼šè¾“å…¥æ–‡æœ¬â†’ç‚¹åŠ å¯†/è§£å¯†â†’å¤åˆ¶/å¯¼å‡ºç»“æœå³å¯</p>
            </div>
            <div class="modal-section">
                <h3 id="modalSection3Title">ä¸‰ã€ 10ç§åŠ å¯†æ–¹å¼åˆ†ç±»è¯´æ˜ï¼ˆé‡ç‚¹ï¼‰</h3>
                <p class="modal-tip" id="modalSection3Tip1">ã€é«˜å®‰å…¨ç±»ã€‘ï¼ˆæ•æ„Ÿ/å•†ç”¨æ•°æ®é¦–é€‰ï¼Œä¿å¯†æ€§å¼ºï¼‰</p>
                <ul id="modalSection3Ul1">
                    <li id="modalSection3Li1">AESåŠ å¯†ï¼šå¯†é’¥16/24/32ä½ï¼Œå›½é™…æ ‡å‡†ï¼Œå®‰å…¨æ€§æé«˜</li>
                    <li id="modalSection3Li2">SM4åŠ å¯†ï¼šå¼ºåˆ¶16ä½å¯†é’¥ï¼Œå›½å†…å•†ç”¨åˆè§„ï¼Œæ”¿ä¼ä¼˜å…ˆç”¨</li>
                    <li id="modalSection3Li3">RC4åŠ å¯†ï¼šä»»æ„å¯†é’¥ï¼Œé€Ÿåº¦å¿«ï¼Œå¹³è¡¡å®‰å…¨ä¸ä¾¿æ·</li>
                </ul>
                <p class="modal-tip" id="modalSection3Tip2">ã€è½»é‡æ··æ·†ç±»ã€‘ï¼ˆæ—¥å¸¸å¿«é€Ÿç”¨ï¼Œæ“ä½œç®€å•ï¼‰</p>
                <ul id="modalSection3Ul2">
                    <li id="modalSection3Li4">å¼‚æˆ–åŠ å¯†ï¼šä»»æ„å¯†é’¥ï¼ŒåŠ å¯†è§£å¯†åŒä¸€å‡½æ•°ï¼Œé€Ÿåº¦æœ€å¿«</li>
                    <li id="modalSection3Li5">å‡¯æ’’å¢å¼ºï¼šæ— éœ€å¯†é’¥ï¼Œå¡«åç§»æ­¥æ•°ï¼Œå…¼å®¹æ‰€æœ‰å­—ç¬¦</li>
                    <li id="modalSection3Li6">å­—ç¬¦ç§»ä½ï¼šæ— éœ€å¯†é’¥ï¼Œå¡«ç§»ä½æ­¥æ•°ï¼Œæ–‡æœ¬è¶Šé•¿æ··æ·†æ•ˆæœè¶Šå¥½</li>
                </ul>
                <p class="modal-tip" id="modalSection3Tip3">ã€ç¼–ç ä¼ è¾“ç±»ã€‘ï¼ˆæ— å¯†é’¥ï¼Œè·¨å¹³å°ä¼ è¾“é¦–é€‰ï¼Œä»…æ··æ·†ï¼‰</p>
                <ul id="modalSection3Ul3">
                    <li id="modalSection3Li7">Base64ï¼šé€šç”¨å…¼å®¹ï¼Œæ‰€æœ‰è®¾å¤‡æ”¯æŒï¼Œä¼ è¾“é¦–é€‰</li>
                    <li id="modalSection3Li8">Base91ï¼šå‹ç¼©æ¯”é«˜15%ï¼Œæ··æ·†æ€§æ¯”Base64å¼º</li>
                    <li id="modalSection3Li9">Base32ï¼šä»…å¤§å†™å­—æ¯+æ•°å­—ï¼Œéšè”½æ€§å¼ºï¼Œä¸æ˜“è¢«è¯†åˆ«</li>
                </ul>
                <p class="modal-tip" id="modalSection3Tip4">ã€è‡ªå®šä¹‰ç±»ã€‘ï¼ˆä¸ªæ€§åŒ–æ··æ·†ï¼Œçµæ´»åº¦é«˜ï¼‰</p>
                <ul id="modalSection3Ul4">
                    <li id="modalSection3Li10">è‡ªå®šä¹‰æ··æ·†ï¼šå¡«åç§»æ­¥æ•°+æ’å…¥å­—ç¬¦ï¼ŒåŒé‡æ··æ·†ï¼Œéœ€å®Œå…¨åŒ¹é…å‚æ•°è§£å¯†</li>
                </ul>
            </div>
            <div class="modal-section">
                <h3 id="modalSection4Title">å››ã€ é™„åŠ åŠŸèƒ½ä½¿ç”¨</h3>
                <ul id="modalSection4Ul1">
                    <li id="modalSection4Li1">å¯¼å…¥TXTï¼šç‚¹ã€Œé€‰æ‹©æ–‡ä»¶ã€ï¼Œä»…æ”¯æŒçº¯æ–‡æœ¬TXTï¼Œå†…å®¹è‡ªåŠ¨å¡«å……</li>
                    <li id="modalSection4Li2">å¯¼å‡ºTXTï¼šç”Ÿæˆç»“æœåç‚¹ã€Œå¯¼å‡ºã€ï¼Œè‡ªåŠ¨å‘½åä¸ºæ—¥æœŸæ ¼å¼ï¼Œæ–¹ä¾¿å½’æ¡£</li>
                    <li id="modalSection4Li3">ä¸€é”®å¤åˆ¶ï¼šç‚¹ã€Œå¤åˆ¶ã€ï¼Œç»“æœå­˜å‰ªè´´æ¿ï¼Œå¼¹çª—æç¤ºæˆåŠŸ</li>
                    <li id="modalSection4Li4">æ·±è‰²æ¨¡å¼ï¼šç‚¹ã€Œåˆ‡æ¢æ·±è‰²æ¨¡å¼ã€ï¼Œè‡ªåŠ¨è®°å¿†çŠ¶æ€ï¼ŒæŠ¤çœ¼èˆ’é€‚</li>
                    <li id="modalSection4Li5">æ¸…ç©ºå†…å®¹ï¼šä¸€é”®é‡ç½®æ‰€æœ‰è¾“å…¥/ç»“æœï¼Œæ¢å¤é»˜è®¤è®¾ç½®</li>
                </ul>
            </div>
            <div class="modal-section">
                <h3 id="modalSection5Title">äº”ã€ å¸¸è§é—®é¢˜æ’æŸ¥ï¼ˆæ’å‘å¿…çœ‹ï¼‰</h3>
                <ul id="modalSection5Ul1">
                    <li id="modalSection5Li1">è§£å¯†å¤±è´¥ï¼šå¯¹ç§°åŠ å¯†ç¡®è®¤å¯†é’¥ä¸€è‡´ï¼Œåç§»ç±»ç¡®è®¤æ­¥æ•°ä¸€è‡´ï¼Œè‡ªå®šä¹‰æ··æ·†ç¡®è®¤æ­¥æ•°+å­—ç¬¦å®Œå…¨ä¸€è‡´</li>
                    <li id="modalSection5Li2">å‡ºç°ä¹±ç ï¼šAES/SM4/å¼‚æˆ–åŠ å¯†åæ­£å¸¸ç°è±¡ï¼Œè§£å¯†åå¯æ¢å¤ï¼Œä¸å½±å“ä½¿ç”¨</li>
                    <li id="modalSection5Li3">å¯¼å…¥å¤±è´¥ï¼šç¡®è®¤æ˜¯.txtæ ¼å¼ï¼Œæ–‡ä»¶ä¸ºçº¯æ–‡æœ¬ï¼Œæ— ç‰¹æ®ŠåŠ å¯†</li>
                    <li id="modalSection5Li4">å¯¼å‡ºå¤±è´¥ï¼šå¼€å¯æµè§ˆå™¨ä¸‹è½½æƒé™ï¼Œä¹Ÿå¯å¤åˆ¶ç»“æœæ‰‹åŠ¨æ–°å»ºTXT</li>
                </ul>
            </div>
            <div class="modal-section">
                <h3 id="modalSection6Title">å…­ã€ å®‰å…¨æç¤º</h3>
                <p id="modalSection6P1">ğŸ”’ æ‰€æœ‰æ“ä½œæœ¬åœ°å®Œæˆï¼Œæ•°æ®ç»å¯¹å®‰å…¨ï¼Œæ— éœ€æ‹…å¿ƒæ³„éœ²</p>
                <p id="modalSection6P2">ğŸ”’ å¯¹ç§°åŠ å¯†å¯†é’¥æ— å¤‡ä»½ï¼Œä¸¢å¤±åæ— æ³•è§£å¯†ï¼ŒåŠ¡å¿…å¦¥å–„ä¿ç®¡</p>
                <p id="modalSection6P3">ğŸ”’ é«˜åº¦æ•æ„Ÿæ•°æ®ä¼˜å…ˆé€‰AES/SM4ï¼Œéæ•æ„Ÿæ•°æ®å¯é€‰è½»é‡æ··æ·†/ç¼–ç </p>
            </div>
        </div>
    </div>

    <script>
        // ========== æ–°å¢ï¼šå¤šè¯­è¨€é…ç½® ==========
        const langConfig = {
            zh: {
                toolTitle: "æ–‡æœ¬åŠ å¯†æ··æ·†å·¥å…·",
                helpBtn: "ä½¿ç”¨è¯´æ˜",
                langToggle: "åˆ‡æ¢è‹±æ–‡",
                themeToggle: "åˆ‡æ¢æ·±è‰²æ¨¡å¼",
                encryptTypeLabel: "åŠ å¯†/è§£å¯†æ–¹å¼ï¼ˆå…±10ç§ï¼‰ï¼š",
                filterAll: "å…¨éƒ¨",
                filterHighSafety: "é«˜å®‰å…¨ç±»",
                filterLightMix: "è½»é‡æ··æ·†ç±»",
                filterEncode: "ç¼–ç ä¼ è¾“ç±»",
                filterCustom: "è‡ªå®šä¹‰ç±»",
                encryptDesc: "ğŸ“Œ é«˜å®‰å…¨ç±»ï¼šAES/SM4éœ€16ä½å¯†é’¥ï½œè½»é‡ç±»ï¼šä»»æ„å¯†é’¥ï¼Œå¿«é€Ÿæ··æ·†<br>ğŸ“Œ ç¼–ç ç±»ï¼šæ— å¯†é’¥ï¼Œæ–¹ä¾¿ä¼ è¾“ï½œè‡ªå®šä¹‰ç±»ï¼šåç§»é‡+æ··æ·†å­—ç¬¦éœ€ä¸€è‡´",
                keyLabel: "AES/SM4/RC4/å¼‚æˆ–/å‡¯æ’’å¢å¼º/ç§»ä½ å¯†é’¥ï¼ˆSM4å¿…å¡«16ä½ï¼Œå…¶ä½™ä»»æ„ï¼‰ï¼š",
                keyPlaceholder: "SM4å›ºå®š16ä½ï¼Œå¦‚abcdef1234567890",
                keyWarning: "âš ï¸ å¯¹ç§°åŠ å¯†å¯†é’¥ä¸¢å¤±æ— æ³•è§£å¯†ï¼Œå›½å¯†SM4å¯†é’¥å¿…é¡»16ä½ï¼",
                offsetLabel: "åç§»/ç§»ä½æ­¥æ•°ï¼ˆå‡¯æ’’å¢å¼º/ç§»ä½/è‡ªå®šä¹‰æ··æ·†ç”¨ï¼Œ1-50ï¼‰ï¼š",
                mixCharsLabel: "æ··æ·†æ’å…¥å­—ç¬¦ï¼ˆä»…è‡ªå®šä¹‰æ··æ·†ç”¨ï¼‰ï¼š",
                mixCharsPlaceholder: "å¦‚ï¼šâ˜…â– â—â–²â—†ï¼ˆè‡ªå®šä¹‰ç‰¹æ®Šå­—ç¬¦ï¼‰",
                fileUploadLabel: "æ‰¹é‡å¯¼å…¥æ–‡æœ¬ï¼ˆæ”¯æŒ.txtæ–‡ä»¶ï¼‰ï¼š",
                fileBtn: "é€‰æ‹©æ–‡ä»¶",
                fileDesc: "å¯¼å…¥åæ–‡æœ¬ä¼šè‡ªåŠ¨å¡«å……åˆ°åŸå§‹æ–‡æœ¬æ¡†ä¸­",
                originTextLabel: "åŸå§‹æ–‡æœ¬ï¼š",
                originTextPlaceholder: "è¾“å…¥/å¯¼å…¥è¦åŠ å¯†/è§£å¯†çš„æ–‡æœ¬ï¼ˆæ”¯æŒæ±‰å­—ã€å­—æ¯ã€æ•°å­—ç­‰ï¼‰...",
                encryptBtn: "åŠ å¯†/æ··æ·†",
                decryptBtn: "è§£å¯†/è¿˜åŸ",
                clearBtn: "æ¸…ç©ºå†…å®¹",
                resultTextLabel: "å¤„ç†ç»“æœï¼š",
                resultTextPlaceholder: "å¤„ç†åçš„ç»“æœ...",
                copyBtn: "å¤åˆ¶",
                exportBtn: "å¯¼å‡ºä¸ºTXT",
                copyTipSuccess: "å¤åˆ¶æˆåŠŸï¼",
                copyTipError: "æš‚æ— å¯å¤åˆ¶å†…å®¹ï¼",
                copyTipImportSuccess: "å¯¼å…¥æˆåŠŸï¼",
                copyTipExportSuccess: "å¯¼å‡ºTXTæˆåŠŸï¼",
                copyTipImportError: "ä»…æ”¯æŒ.txtæ–‡ä»¶ï¼",
                copyTipFileReadError: "æ–‡ä»¶è¯»å–å¤±è´¥ï¼",
                modalTitle: "æ–‡æœ¬åŠ å¯†æ··æ·†å·¥å…· ä½¿ç”¨è¯´æ˜ä¹¦",
                modalSection1Title: "ä¸€ã€ å·¥å…·åŸºç¡€ä¿¡æ¯",
                modalSection1P1: "âœ… æ ¸å¿ƒåŠŸèƒ½ï¼š10ç§æ–‡æœ¬åŠ å¯†/è§£å¯†/æ··æ·†/ç¼–ç ï¼Œå…¼å®¹æ±‰å­—ã€å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šç¬¦å·",
                modalSection1P2: "âœ… è¿è¡Œæ–¹å¼ï¼šçº¯å‰ç«¯æœ¬åœ°å¤„ç†ï¼Œæ•°æ®ä¸ä¸Šä¼ ï¼Œæ— æ³„éœ²é£é™©",
                modalSection1P3: "âœ… é™„åŠ åŠŸèƒ½ï¼šTXTå¯¼å…¥å¯¼å‡ºã€ä¸€é”®å¤åˆ¶ã€æ·±è‰²æ¨¡å¼ã€åˆ†ç±»ç­›é€‰ã€å†…ç½®è¯´æ˜ä¹¦",
                modalSection1P4: "âœ… é€‚ç”¨è®¾å¤‡ï¼šç”µè„‘/æ‰‹æœºæµè§ˆå™¨é€šç”¨ï¼Œéƒ¨ç½²åå¯è·¨è®¾å¤‡è®¿é—®",
                modalSection2Title: "äºŒã€ 3æ­¥å¿«é€Ÿä¸Šæ‰‹ï¼ˆæ–°æ‰‹å¿…çœ‹ï¼‰",
                modalSection2P1: "1.  é€‰æ–¹å¼ï¼šç‚¹é¡¶éƒ¨ç­›é€‰æ ‡ç­¾ï¼ˆæ¨èï¼‰æˆ–ä¸‹æ‹‰æ¡†ï¼Œå¿«é€ŸåŒ¹é…ä½¿ç”¨åœºæ™¯",
                modalSection2P2: "2.  å¡«å‚æ•°ï¼šæŒ‰éœ€å¡«å¯†é’¥/æ­¥æ•°/æ··æ·†å­—ç¬¦ï¼Œç¼–ç ç±»æ— éœ€å¡«ä»»ä½•å‚æ•°",
                modalSection2P3: "3.  å‡ºç»“æœï¼šè¾“å…¥æ–‡æœ¬â†’ç‚¹åŠ å¯†/è§£å¯†â†’å¤åˆ¶/å¯¼å‡ºç»“æœå³å¯",
                modalSection3Title: "ä¸‰ã€ 10ç§åŠ å¯†æ–¹å¼åˆ†ç±»è¯´æ˜ï¼ˆé‡ç‚¹ï¼‰",
                modalSection3Tip1: "ã€é«˜å®‰å…¨ç±»ã€‘ï¼ˆæ•æ„Ÿ/å•†ç”¨æ•°æ®é¦–é€‰ï¼Œä¿å¯†æ€§å¼ºï¼‰",
                modalSection3Li1: "AESåŠ å¯†ï¼šå¯†é’¥16/24/32ä½ï¼Œå›½é™…æ ‡å‡†ï¼Œå®‰å…¨æ€§æé«˜",
                modalSection3Li2: "SM4åŠ å¯†ï¼šå¼ºåˆ¶16ä½å¯†é’¥ï¼Œå›½å†…å•†ç”¨åˆè§„ï¼Œæ”¿ä¼ä¼˜å…ˆç”¨",
                modalSection3Li3: "RC4åŠ å¯†ï¼šä»»æ„å¯†é’¥ï¼Œé€Ÿåº¦å¿«ï¼Œå¹³è¡¡å®‰å…¨ä¸ä¾¿æ·",
                modalSection3Tip2: "ã€è½»é‡æ··æ·†ç±»ã€‘ï¼ˆæ—¥å¸¸å¿«é€Ÿç”¨ï¼Œæ“ä½œç®€å•ï¼‰",
                modalSection3Li4: "å¼‚æˆ–åŠ å¯†ï¼šä»»æ„å¯†é’¥ï¼ŒåŠ å¯†è§£å¯†åŒä¸€å‡½æ•°ï¼Œé€Ÿåº¦æœ€å¿«",
                modalSection3Li5: "å‡¯æ’’å¢å¼ºï¼šæ— éœ€å¯†é’¥ï¼Œå¡«åç§»æ­¥æ•°ï¼Œå…¼å®¹æ‰€æœ‰å­—ç¬¦",
                modalSection3Li6: "å­—ç¬¦ç§»ä½ï¼šæ— éœ€å¯†é’¥ï¼Œå¡«ç§»ä½æ­¥æ•°ï¼Œæ–‡æœ¬è¶Šé•¿æ··æ·†æ•ˆæœè¶Šå¥½",
                modalSection3Tip3: "ã€ç¼–ç ä¼ è¾“ç±»ã€‘ï¼ˆæ— å¯†é’¥ï¼Œè·¨å¹³å°ä¼ è¾“é¦–é€‰ï¼Œä»…æ··æ·†ï¼‰",
                modalSection3Li7: "Base64ï¼šé€šç”¨å…¼å®¹ï¼Œæ‰€æœ‰è®¾å¤‡æ”¯æŒï¼Œä¼ è¾“é¦–é€‰",
                modalSection3Li8: "Base91ï¼šå‹ç¼©æ¯”é«˜15%ï¼Œæ··æ·†æ€§æ¯”Base64å¼º",
                modalSection3Li9: "Base32ï¼šä»…å¤§å†™å­—æ¯+æ•°å­—ï¼Œéšè”½æ€§å¼ºï¼Œä¸æ˜“è¢«è¯†åˆ«",
                modalSection3Tip4: "ã€è‡ªå®šä¹‰ç±»ã€‘ï¼ˆä¸ªæ€§åŒ–æ··æ·†ï¼Œçµæ´»åº¦é«˜ï¼‰",
                modalSection3Li10: "è‡ªå®šä¹‰æ··æ·†ï¼šå¡«åç§»æ­¥æ•°+æ’å…¥å­—ç¬¦ï¼ŒåŒé‡æ··æ·†ï¼Œéœ€å®Œå…¨åŒ¹é…å‚æ•°è§£å¯†",
                modalSection4Title: "å››ã€ é™„åŠ åŠŸèƒ½ä½¿ç”¨",
                modalSection4Li1: "å¯¼å…¥TXTï¼šç‚¹ã€Œé€‰æ‹©æ–‡ä»¶ã€ï¼Œä»…æ”¯æŒçº¯æ–‡æœ¬TXTï¼Œå†…å®¹è‡ªåŠ¨å¡«å……",
                modalSection4Li2: "å¯¼å‡ºTXTï¼šç”Ÿæˆç»“æœåç‚¹ã€Œå¯¼å‡ºã€ï¼Œè‡ªåŠ¨å‘½åä¸ºæ—¥æœŸæ ¼å¼ï¼Œæ–¹ä¾¿å½’æ¡£",
                modalSection4Li3: "ä¸€é”®å¤åˆ¶ï¼šç‚¹ã€Œå¤åˆ¶ã€ï¼Œç»“æœå­˜å‰ªè´´æ¿ï¼Œå¼¹çª—æç¤ºæˆåŠŸ",
                modalSection4Li4: "æ·±è‰²æ¨¡å¼ï¼šç‚¹ã€Œåˆ‡æ¢æ·±è‰²æ¨¡å¼ã€ï¼Œè‡ªåŠ¨è®°å¿†çŠ¶æ€ï¼ŒæŠ¤çœ¼èˆ’é€‚",
                modalSection4Li5: "æ¸…ç©ºå†…å®¹ï¼šä¸€é”®é‡ç½®æ‰€æœ‰è¾“å…¥/ç»“æœï¼Œæ¢å¤é»˜è®¤è®¾ç½®",
                modalSection5Title: "äº”ã€ å¸¸è§é—®é¢˜æ’æŸ¥ï¼ˆæ’å‘å¿…çœ‹ï¼‰",
                modalSection5Li1: "è§£å¯†å¤±è´¥ï¼šå¯¹ç§°åŠ å¯†ç¡®è®¤å¯†é’¥ä¸€è‡´ï¼Œåç§»ç±»ç¡®è®¤æ­¥æ•°ä¸€è‡´ï¼Œè‡ªå®šä¹‰æ··æ·†ç¡®è®¤æ­¥æ•°+å­—ç¬¦å®Œå…¨ä¸€è‡´",
                modalSection5Li2: "å‡ºç°ä¹±ç ï¼šAES/SM4/å¼‚æˆ–åŠ å¯†åæ­£å¸¸ç°è±¡ï¼Œè§£å¯†åå¯æ¢å¤ï¼Œä¸å½±å“ä½¿ç”¨",
                modalSection5Li3: "å¯¼å…¥å¤±è´¥ï¼šç¡®è®¤æ˜¯.txtæ ¼å¼ï¼Œæ–‡ä»¶ä¸ºçº¯æ–‡æœ¬ï¼Œæ— ç‰¹æ®ŠåŠ å¯†",
                modalSection5Li4: "å¯¼å‡ºå¤±è´¥ï¼šå¼€å¯æµè§ˆå™¨ä¸‹è½½æƒé™ï¼Œä¹Ÿå¯å¤åˆ¶ç»“æœæ‰‹åŠ¨æ–°å»ºTXT",
                modalSection6Title: "å…­ã€ å®‰å…¨æç¤º",
                modalSection6P1: "ğŸ”’ æ‰€æœ‰æ“ä½œæœ¬åœ°å®Œæˆï¼Œæ•°æ®ç»å¯¹å®‰å…¨ï¼Œæ— éœ€æ‹…å¿ƒæ³„éœ²",
                modalSection6P2: "ğŸ”’ å¯¹ç§°åŠ å¯†å¯†é’¥æ— å¤‡ä»½ï¼Œä¸¢å¤±åæ— æ³•è§£å¯†ï¼ŒåŠ¡å¿…å¦¥å–„ä¿ç®¡",
                modalSection6P3: "ğŸ”’ é«˜åº¦æ•æ„Ÿæ•°æ®ä¼˜å…ˆé€‰AES/SM4ï¼Œéæ•æ„Ÿæ•°æ®å¯é€‰è½»é‡æ··æ·†/ç¼–ç ",
                alertNoText: "è¯·è¾“å…¥åŸå§‹æ–‡æœ¬ï¼",
                alertNoDecryptText: "è¯·è¾“å…¥å¾…è§£å¯†æ–‡æœ¬ï¼",
                alertAESKey: "AESå¯†é’¥å¿…é¡»æ˜¯16/24/32ä½ï¼",
                alertSM4Key: "SM4å›½å¯†å¯†é’¥å¿…é¡»æ˜¯16ä½ï¼",
                alertXORKey: "è¯·è¾“å…¥å¼‚æˆ–å¯†é’¥",
                alertRC4Key: "è¯·è¾“å…¥RC4å¯†é’¥",
                alertBase91Format: "Base91æ ¼å¼é”™è¯¯",
                alertBase64Format: "Base64æ ¼å¼é”™è¯¯",
                alertCustomMixFormat: "éè‡ªå®šä¹‰æ··æ·†æ–‡æœ¬",
                alertAESEncryptFormat: "AESå¯†æ–‡æ ¼å¼é”™è¯¯"
            },
            en: {
                toolTitle: "Text Obfuscation Tool",
                helpBtn: "User Guide",
                langToggle: "Switch to Chinese",
                themeToggle: "Toggle Dark Mode",
                encryptTypeLabel: "Encryption/Decryption Method (10 types in total)ï¼š",
                filterAll: "All",
                filterHighSafety: "High Security",
                filterLightMix: "Light Obfuscation",
                filterEncode: "Encoding & Transmission",
                filterCustom: "Custom",
                encryptDesc: "ğŸ“Œ High Security: AES/SM4 requires 16-bit keyï½œLight: Any key, fast obfuscation<br>ğŸ“Œ Encoding: No key needed, easy transmissionï½œCustom: Offset + mix chars must match",
                keyLabel: "Key for AES/SM4/RC4/XOR/Caesar Plus/Shift (SM4 requires 16 bits, others arbitrary)ï¼š",
                keyPlaceholder: "SM4 fixed 16 bits, e.g., abcdef1234567890",
                keyWarning: "âš ï¸ Symmetric encryption key loss cannot decrypt, SM4 key must be 16 bits!",
                offsetLabel: "Offset/Shift Steps (for Caesar Plus/Shift/Custom Obfuscation, 1-50)ï¼š",
                mixCharsLabel: "Obfuscation Insert Characters (only for custom obfuscation)ï¼š",
                mixCharsPlaceholder: "e.g., â˜…â– â—â–²â—† (custom special characters)",
                fileUploadLabel: "Batch Import Text (supports .txt files)ï¼š",
                fileBtn: "Select File",
                fileDesc: "After import, text will be automatically filled into the original text box",
                originTextLabel: "Original Textï¼š",
                originTextPlaceholder: "Enter/import text to encrypt/decrypt (supports Chinese, letters, numbers, etc.)...",
                encryptBtn: "Encrypt/Obfuscate",
                decryptBtn: "Decrypt/Restore",
                clearBtn: "Clear All",
                resultTextLabel: "Processing Resultï¼š",
                resultTextPlaceholder: "Processed result...",
                copyBtn: "Copy",
                exportBtn: "Export as TXT",
                copyTipSuccess: "Copy Success!",
                copyTipError: "No content to copy!",
                copyTipImportSuccess: "Import Success!",
                copyTipExportSuccess: "Export TXT Success!",
                copyTipImportError: "Only .txt files are supported!",
                copyTipFileReadError: "File read failed!",
                modalTitle: "Text Obfuscation Tool - User Guide",
                modalSection1Title: "1. Tool Basic Information",
                modalSection1P1: "âœ… Core Function: 10 types of text encryption/decryption/obfuscation/encoding, supports Chinese, letters, numbers, special symbols",
                modalSection1P2: "âœ… Running Mode: Pure front-end local processing, no data upload, no leakage risk",
                modalSection1P3: "âœ… Additional Functions: TXT import/export, one-click copy, dark mode, category filter, built-in user guide",
                modalSection1P4: "âœ… Applicable Devices: Universal for computer/mobile browsers, accessible across devices after deployment",
                modalSection2Title: "2. Quick Start in 3 Steps (For Beginners)",
                modalSection2P1: "1. Select Method: Click top filter tags (recommended) or dropdown box to match usage scenarios quickly",
                modalSection2P2: "2. Fill Parameters: Fill in key/steps/mix chars as needed, no parameters needed for encoding types",
                modalSection2P3: "3. Get Result: Enter text â†’ click Encrypt/Decrypt â†’ copy/export result",
                modalSection3Title: "3. Classification of 10 Encryption Methods (Key Point)",
                modalSection3Tip1: "[High Security] (First choice for sensitive/commercial data, strong confidentiality)",
                modalSection3Li1: "AES Encryption: Key 16/24/32 bits, international standard, extremely high security",
                modalSection3Li2: "SM4 Encryption: Mandatory 16-bit key, domestic commercial compliance, preferred for government/enterprise",
                modalSection3Li3: "RC4 Encryption: Any key, fast speed, balance security and convenience",
                modalSection3Tip2: "[Light Obfuscation] (Daily quick use, simple operation)",
                modalSection3Li4: "XOR Encryption: Any key, same function for encryption/decryption, fastest speed",
                modalSection3Li5: "Caesar Plus: No key needed, fill offset steps, supports all characters",
                modalSection3Li6: "Character Shift: No key needed, fill shift steps, better obfuscation for longer text",
                modalSection3Tip3: "[Encoding & Transmission] (No key, first choice for cross-platform transmission, only obfuscation)",
                modalSection3Li7: "Base64: Universal compatibility, supported by all devices, first choice for transmission",
                modalSection3Li8: "Base91: 15% higher compression ratio, stronger obfuscation than Base64",
                modalSection3Li9: "Base32: Only uppercase letters + numbers, strong concealment, hard to identify",
                modalSection3Tip4: "[Custom] (Personalized obfuscation, high flexibility)",
                modalSection3Li10: "Custom Obfuscation: Fill offset steps + insert characters, double obfuscation, parameters must match for decryption",
                modalSection4Title: "4. Use of Additional Functions",
                modalSection4Li1: "Import TXT: Click ã€ŒSelect Fileã€, only supports plain text TXT, content auto-filled",
                modalSection4Li2: "Export TXT: Click ã€ŒExportã€ after generating result, auto-named by date for easy archiving",
                modalSection4Li3: "One-click Copy: Click ã€ŒCopyã€, result saved to clipboard, popup prompt success",
                modalSection4Li4: "Dark Mode: Click ã€ŒToggle Dark Modeã€, auto-save state, eye-friendly",
                modalSection4Li5: "Clear All: One-click reset all inputs/results, restore default settings",
                modalSection5Title: "5. Common Problem Troubleshooting (Must Read)",
                modalSection5Li1: "Decryption failed: Confirm key consistency for symmetric encryption, step consistency for offset types, step + char consistency for custom obfuscation",
                modalSection5Li2: "Garbled text: Normal for AES/SM4/XOR encryption, recoverable after decryption, no impact on use",
                modalSection5Li3: "Import failed: Confirm it's .txt format, plain text, no special encryption",
                modalSection5Li4: "Export failed: Enable browser download permission, or copy result to create TXT manually",
                modalSection6Title: "6. Security Tips",
                modalSection6P1: "ğŸ”’ All operations completed locally, data absolutely safe, no need to worry about leakage",
                modalSection6P2: "ğŸ”’ No backup for symmetric encryption keys, cannot decrypt if lost, keep properly",
                modalSection6P3: "ğŸ”’ Choose AES/SM4 for highly sensitive data, light obfuscation/encoding for non-sensitive data",
                alertNoText: "Please enter original text!",
                alertNoDecryptText: "Please enter text to decrypt!",
                alertAESKey: "AES key must be 16/24/32 bits!",
                alertSM4Key: "SM4 national encryption key must be 16 bits!",
                alertXORKey: "Please enter XOR key",
                alertRC4Key: "Please enter RC4 key",
                alertBase91Format: "Base91 format error",
                alertBase64Format: "Base64 format error",
                alertCustomMixFormat: "Not custom obfuscated text",
                alertAESEncryptFormat: "AES ciphertext format error"
            }
        };

        // DOMå…ƒç´ è·å–
        const getDom = id => document.getElementById(id);
        const originText = getDom('originText');
        const resultText = getDom('resultText');
        const aesKey = getDom('aesKey');
        const mixOffset = getDom('mixOffset');
        const mixChars = getDom('mixChars');
        const encryptType = getDom('encryptType');
        const themeToggle = getDom('themeToggle');
        const copyTip = getDom('copyTip');
        const fileInput = getDom('fileInput');
        const filterTags = document.querySelectorAll('.filter-tag');
        const helpModal = getDom('helpModal');
        const helpBtn = getDom('helpBtn');
        const modalClose = getDom('modalClose');
        const modalMask = getDom('modalMask');
        const langToggle = getDom('langToggle');

        // ========== æ–°å¢ï¼šå¤šè¯­è¨€åˆ‡æ¢æ ¸å¿ƒé€»è¾‘ ==========
        // åˆå§‹åŒ–è¯­è¨€
        let currentLang = localStorage.getItem('textCryptoLang') || 'zh';
        // æ›´æ–°ç•Œé¢æ–‡å­—
        function updateLang(lang) {
            // æ›´æ–°é™æ€æ–‡æœ¬
            Object.keys(langConfig[lang]).forEach(key => {
                const el = getDom(key);
                if (el) {
                    if (key.includes('Placeholder')) {
                        el.placeholder = langConfig[lang][key];
                    } else if (key === 'encryptDesc' || key.includes('P') || key.includes('Li') || key.includes('Tip')) {
                        el.innerHTML = langConfig[lang][key];
                    } else {
                        el.textContent = langConfig[lang][key];
                    }
                }
            });
            // æ›´æ–°ä¸‹æ‹‰æ¡†é€‰é¡¹
            const options = encryptType.options;
            for (let i = 0; i < options.length; i++) {
                options[i].textContent = options[i].getAttribute(`data-lang-${lang}`);
            }
            // æ›´æ–°é¡µé¢langå±æ€§
            document.documentElement.lang = lang === 'zh' ? 'zh-CN' : 'en';
            // ä¿å­˜è¯­è¨€çŠ¶æ€
            localStorage.setItem('textCryptoLang', lang);
            currentLang = lang;
        }
        // åˆå§‹åŒ–è¯­è¨€
        updateLang(currentLang);

        // è¯­è¨€åˆ‡æ¢æŒ‰é’®äº‹ä»¶
        langToggle.addEventListener('click', () => {
            const newLang = currentLang === 'zh' ? 'en' : 'zh';
            updateLang(newLang);
        });

        // æ·±è‰²æ¨¡å¼
        const initTheme = () => {
            const savedTheme = localStorage.getItem('textCryptoTheme');
            if (savedTheme === 'dark') {
                document.documentElement.classList.add('dark');
                themeToggle.textContent = currentLang === 'zh' ? 'åˆ‡æ¢æµ…è‰²æ¨¡å¼' : 'Toggle Light Mode';
            } else {
                document.documentElement.classList.remove('dark');
                themeToggle.textContent = currentLang === 'zh' ? 'åˆ‡æ¢æ·±è‰²æ¨¡å¼' : 'Toggle Dark Mode';
            }
        };
        themeToggle.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('textCryptoTheme', isDark ? 'dark' : 'light');
            themeToggle.textContent = isDark 
                ? (currentLang === 'zh' ? 'åˆ‡æ¢æµ…è‰²æ¨¡å¼' : 'Toggle Light Mode') 
                : (currentLang === 'zh' ? 'åˆ‡æ¢æ·±è‰²æ¨¡å¼' : 'Toggle Dark Mode');
        });
        window.onload = () => {
            initTheme();
            updateLang(currentLang);
        };

        // æ‰¹é‡å¯¼å…¥
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];if (!file) return;
            if (file.type !== 'text/plain' && !file.name.endsWith('.txt')) {
                showCopyTip(currentLang === 'zh' ? 'ä»…æ”¯æŒ.txtæ–‡ä»¶ï¼' : 'Only .txt files are supported!', false);
                fileInput.value = '';return;
            }
            const reader = new FileReader();
            reader.onload = (event) => {
                originText.value = event.target.result;
                showCopyTip(currentLang === 'zh' ? 'å¯¼å…¥æˆåŠŸï¼' : 'Import Success!', true);
                fileInput.value = '';
            };
            reader.onerror = () => {
                showCopyTip(currentLang === 'zh' ? 'æ–‡ä»¶è¯»å–å¤±è´¥ï¼' : 'File read failed!', false);
                fileInput.value = '';
            };
            reader.readAsText(file, 'UTF-8');
        });

        // å¤åˆ¶+å¯¼å‡º
        function copyResult() {
            const text = resultText.value.trim();
            if (!text) {
                showCopyTip(currentLang === 'zh' ? 'æš‚æ— å¯å¤åˆ¶å†…å®¹ï¼' : 'No content to copy!', false);
                return;
            }
            navigator.clipboard.writeText(text).then(() => {
                showCopyTip(currentLang === 'zh' ? 'å¤åˆ¶æˆåŠŸï¼' : 'Copy Success!', true);
            }).catch(err => {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showCopyTip(err ? (currentLang === 'zh' ? 'å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ï¼' : 'Copy failed, please copy manually!') : (currentLang === 'zh' ? 'å¤åˆ¶æˆåŠŸï¼' : 'Copy Success!'), !err);
            });
        }

        function exportResult() {
            const text = resultText.value.trim();
            if (!text) {
                showCopyTip(currentLang === 'zh' ? 'æš‚æ— å¯å¯¼å‡ºå†…å®¹ï¼' : 'No content to export!', false);
                return;
            }
            const blob = new Blob([text], { type: 'text/plain; charset=utf-8' });
            const a = document.createElement('a');
            const date = new Date();
            const fileName = `text_${date.getFullYear()}${(date.getMonth()+1).toString().padStart(2, '0')}${date.getDate().toString().padStart(2, '0')}${date.getHours().toString().padStart(2, '0')}${date.getMinutes().toString().padStart(2, '0')}.txt`;
            a.download = fileName;
            a.href = URL.createObjectURL(blob);
            a.click();
            URL.revokeObjectURL(a.href);
            showCopyTip(currentLang === 'zh' ? 'å¯¼å‡ºTXTæˆåŠŸï¼' : 'Export TXT Success!', true);
        }

        function showCopyTip(text, isSuccess) {
            copyTip.textContent = text;
            copyTip.className = 'copy-tip ' + (isSuccess ? 'success' : 'error');
            copyTip.classList.add('show');
            setTimeout(() => copyTip.classList.remove('show'), 3000);
        }

        // åŠ å¯†æ–¹å¼ç­›é€‰
        filterTags.forEach(tag => {
            tag.addEventListener('click', () => {
                filterTags.forEach(t => t.classList.remove('active'));
                tag.classList.add('active');
                const targetCate = tag.dataset.type;
                const allOptions = encryptType.options;
                let hasSelected = false;
                for (let i = 0; i < allOptions.length; i++) {
                    const option = allOptions[i];
                    if (targetCate === 'all' || option.dataset.cate === targetCate) {
                        option.style.display = 'block';
                        if (!hasSelected) {
                            encryptType.selectedIndex = i;
                            hasSelected = true;
                        }
                    } else {
                        option.style.display = 'none';
                    }
                }
            });
        });

        // è¯´æ˜ä¹¦å¼¹çª—æ§åˆ¶
        helpBtn.addEventListener('click', () => {
            helpModal.style.display = 'block';
            document.querySelector('.modal-content').scrollTop = 0;
        });

        function closeModal() {
            helpModal.style.display = 'none';
        }

        modalClose.addEventListener('click', closeModal);
        modalMask.addEventListener('click', closeModal);
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && helpModal.style.display === 'block') closeModal();
        });

        // 10ç§åŠ å¯†è§£å¯†å®Œæ•´é€»è¾‘
        function sm4Encrypt(text, key) {
            const keyUtf8 = CryptoJS.enc.Utf8.parse(key.padEnd(16, '0').slice(0, 16));
            const textUtf8 = CryptoJS.enc.Utf8.parse(text);
            const encrypted = CryptoJS.AES.encrypt(textUtf8, keyUtf8, { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.ZeroPadding });
            return encrypted.ciphertext.toString(CryptoJS.enc.Hex);
        }

        function sm4Decrypt(text, key) {
            const keyUtf8 = CryptoJS.enc.Utf8.parse(key.padEnd(16, '0').slice(0, 16));
            const ciphertext = CryptoJS.enc.Hex.parse(text);
            const decrypted = CryptoJS.AES.decrypt({ciphertext: ciphertext}, keyUtf8, { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.ZeroPadding });
            return decrypted.toString(CryptoJS.enc.Utf8).replace(/\0/g, '');
        }

        function caesarPlusEncrypt(text, offset) {
            offset = Number(offset) || 5;
            return text.split('').map(char => String.fromCharCode(char.charCodeAt(0) + offset)).join('');
        }

        function caesarPlusDecrypt(text, offset) {
            offset = Number(offset) || 5;
            return text.split('').map(char => String.fromCharCode(char.charCodeAt(0) - offset)).join('');
        }

        function charMoveEncrypt(text, step) {
            step = Number(step) || 5;
            if(text.length ===0) return '';
            step = step % text.length;
            return text.slice(step) + text.slice(0, step);
        }

        function charMoveDecrypt(text, step) {
            step = Number(step) || 5;
            if(text.length ===0) return '';
            step = step % text.length;
            return text.slice(-step) + text.slice(0, -step);
        }

        function base32Encode(text) {
            const dict = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
            const bytes = new TextEncoder().encode(text);
            let bits = '', result = '';
            bytes.forEach(byte => bits += byte.toString(2).padStart(8, '0'));
            for (let i=0; i<bits.length; i+=5) {
                const chunk = bits.slice(i, i+5).padEnd(5, '0');
                result += dict[parseInt(chunk, 2)];
            }
            return result.padEnd(Math.ceil(result.length/8)*8, '=');
        }

        function base32Decode(text) {
            const dict = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
            text = text.replace(/=/g, '');
            let bits = '', result = [];
            text.split('').forEach(char => bits += dict.indexOf(char).toString(2).padStart(5, '0'));
            for (let i=0; i<bits.length; i+=8) {
                const byte = bits.slice(i, i+8);
                if (byte.length ===8) result.push(parseInt(byte, 2));
            }
            return new TextDecoder().decode(new Uint8Array(result));
        }

        function aesEncrypt(text, key) {
            const processedKey = CryptoJS.enc.Utf8.parse(key.padEnd(32, '0').slice(0, 32));
            const iv = CryptoJS.lib.WordArray.random(16);
            const encrypted = CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(text), processedKey, { iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7 });
            return iv.toString(CryptoJS.enc.Hex) + '|' + encrypted.ciphertext.toString(CryptoJS.enc.Hex);
        }

        function aesDecrypt(text, key) {
            const [ivHex, cipherHex] = text.split('|');
            if (!ivHex || !cipherHex) throw new Error(currentLang === 'zh' ? 'AESå¯†æ–‡æ ¼å¼é”™è¯¯' : 'AES ciphertext format error');
            const processedKey = CryptoJS.enc.Utf8.parse(key.padEnd(32, '0').slice(0, 32));
            const iv = CryptoJS.enc.Hex.parse(ivHex);
            const ciphertext = CryptoJS.enc.Hex.parse(cipherHex);
            const decrypted = CryptoJS.AES.decrypt({ ciphertext: ciphertext }, processedKey, { iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7 });
            return decrypted.toString(CryptoJS.enc.Utf8);
        }

        function xorEncryptDecrypt(text, key) {
            if (!key) throw new Error(currentLang === 'zh' ? 'è¯·è¾“å…¥å¼‚æˆ–å¯†é’¥' : 'Please enter XOR key');
            let result = '';
            for (let i = 0; i < text.length; i++) result += String.fromCharCode(text.charCodeAt(i) ^ key.charCodeAt(i % key.length));
            return btoa(encodeURIComponent(result));
        }

        function rc4EncryptDecrypt(text, key) {
            if (!key) throw new Error(currentLang === 'zh' ? 'è¯·è¾“å…¥RC4å¯†é’¥' : 'Please enter RC4 key');
            const keyUtf8 = CryptoJS.enc.Utf8.parse(key);
            const textUtf8 = CryptoJS.enc.Utf8.parse(text);
            const encrypted = CryptoJS.RC4.encrypt(textUtf8, keyUtf8);
            return encrypted.toString();
        }

        function rc4Decrypt(text, key) {
            if (!key) throw new Error(currentLang === 'zh' ? 'è¯·è¾“å…¥RC4å¯†é’¥' : 'Please enter RC4 key');
            const keyUtf8 = CryptoJS.enc.Utf8.parse(key);
            const decrypted = CryptoJS.RC4.decrypt(text, keyUtf8);
            return decrypted.toString(CryptoJS.enc.Utf8);
        }

        function base91Encode(text) {
            const bytes = new TextEncoder().encode(text);
            let bitBuf = 0, bitLen = 0, out = '';
            const dict = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%&()*+,./:;<=>?@[]^_`{|}~"';
            for (let b of bytes) {
                bitBuf = (bitBuf << 8) | b;
                bitLen += 8;
                while (bitLen >= 13) {
                    bitLen -=13;
                    let val = (bitBuf >> bitLen) & 8191;
                    out += dict[val%91] + dict[Math.floor(val/91)];
                }
            }
            if (bitLen > 0) {
                bitBuf <<= (13 - bitLen);
                out += dict[bitBuf & 8191 %91];
                if(bitLen > 6) out += dict[Math.floor((bitBuf & 8191)/91)];
            }
            return out;
        }

        function base91Decode(text) {
            const dict = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%&()*+,./:;<=>?@[]^_`{|}~"';
            let bitBuf = 0, bitLen = 0, out = [];
            for (let i=0; i<text.length; i+=2) {
                const a = dict.indexOf(text[i]), b = dict.indexOf(text[i+1]);
                if (a === -1 || b === -1) throw new Error(currentLang === 'zh' ? 'Base91æ ¼å¼é”™è¯¯' : 'Base91 format error');
                bitBuf = (bitBuf << 13) | (a + b*91);
                bitLen +=13;
                while (bitLen >=8) {
                    bitLen -=8;
                    out.push(bitBuf >> bitLen);
                }
            }
            return new TextDecoder().decode(new Uint8Array(out));
        }

        function base64Encrypt(text) {
            return btoa(encodeURIComponent(text));
        }

        function base64Decrypt(text) {
            try {
                return decodeURIComponent(atob(text));
            } catch (e) {
                throw new Error(currentLang === 'zh' ? 'Base64æ ¼å¼é”™è¯¯' : 'Base64 format error');
            }
        }

        function customMixEncrypt(text, offset, mixCharsStr) {
            if (!mixCharsStr) mixCharsStr = 'â˜…â– â—â–²â—†';
            const offsetNum = Number(offset) || 5;
            const mixCharsArr = mixCharsStr.split('');
            let offsetText = text.split('').map(char => String.fromCharCode(char.charCodeAt(0) + offsetNum)).join('');
            const insertInterval = 3;
            let mixedText = '';
            for (let i = 0; i < offsetText.length; i++) {
                mixedText += offsetText[i];
                if ((i + 1) % insertInterval === 0) mixedText += mixCharsArr[Math.floor(Math.random() * mixCharsArr.length)];
            }
            return `[CUSTOM_MIX]${mixedText}[END]`;
        }

        function customMixDecrypt(text, offset, mixCharsStr) {
            if (!text.startsWith('[CUSTOM_MIX]') || !text.endsWith('[END]')) throw new Error(currentLang === 'zh' ? 'éè‡ªå®šä¹‰æ··æ·†æ–‡æœ¬' : 'Not custom obfuscated text');
            const offsetNum = Number(offset) || 5;
            if (!mixCharsStr) mixCharsStr = 'â˜…â– â—â–²â—†';
            const mixCharsArr = mixCharsStr.split('');
            let pureText = text.slice(11, -5);
            pureText = pureText.split('').filter(char => !mixCharsArr.includes(char)).join('');
            return pureText.split('').map(char => String.fromCharCode(char.charCodeAt(0) - offsetNum)).join('');
        }

        // ç»Ÿä¸€åŠ å¯†è§£å¯†å…¥å£
        function encryptText() {
            const text = originText.value.trim();
            const type = encryptType.value;
            if (!text) {
                alert(currentLang === 'zh' ? 'è¯·è¾“å…¥åŸå§‹æ–‡æœ¬ï¼' : 'Please enter original text!');
                return;
            }
            try {
                let result = '';
                const key = aesKey.value.trim();
                const step = mixOffset.value;
                switch (type) {
                    case 'aes':
                        if (!key || [16,24,32].indexOf(key.length) === -1) {
                            alert(currentLang === 'zh' ? 'AESå¯†é’¥å¿…é¡»æ˜¯16/24/32ä½ï¼' : 'AES key must be 16/24/32 bits!');
                            return;
                        }
                        result = aesEncrypt(text, key);
                        break;
                    case 'sm4':
                        if (!key || key.length !==16) {
                            alert(currentLang === 'zh' ? 'SM4å›½å¯†å¯†é’¥å¿…é¡»æ˜¯16ä½ï¼' : 'SM4 national encryption key must be 16 bits!');
                            return;
                        }
                        result = sm4Encrypt(text, key);
                        break;
                    case 'rc4':
                        result = rc4EncryptDecrypt(text, key);
                        break;
                    case 'xor':
                        result = xorEncryptDecrypt(text, key);
                        break;
                    case 'caesarPlus':
                        result = caesarPlusEncrypt(text, step);
                        break;
                    case 'charMove':
                        result = charMoveEncrypt(text, step);
                        break;
                    case 'base91':
                        result = base91Encode(text);
                        break;
                    case 'base64':
                        result = base64Encrypt(text);
                        break;
                    case 'base32':
                        result = base32Encode(text);
                        break;
                    case 'customMix':
                        result = customMixEncrypt(text, step, mixChars.value.trim());
                        break;
                }
                resultText.value = result;
            } catch (e) {
                alert((currentLang === 'zh' ? 'åŠ å¯†å¤±è´¥ï¼š' : 'Encryption failed: ') + e.message);
            }
        }

        function decryptText() {
            const text = originText.value.trim();
            const type = encryptType.value;
            if (!text) {
                alert(currentLang === 'zh' ? 'è¯·è¾“å…¥å¾…è§£å¯†æ–‡æœ¬ï¼' : 'Please enter text to decrypt!');
                return;
            }
            try {
                let result = '';
                const key = aesKey.value.trim();
                const step = mixOffset.value;
                switch (type) {
                    case 'aes':
                        if (!key || [16,24,32].indexOf(key.length) === -1) {
                            alert(currentLang === 'zh' ? 'AESå¯†é’¥å¿…é¡»æ˜¯16/24/32ä½ï¼' : 'AES key must be 16/24/32 bits!');
                            return;
                        }
                        result = aesDecrypt(text, key);
                        break;
                    case 'sm4':
                        if (!key || key.length !==16) {
                            alert(currentLang === 'zh' ? 'SM4å›½å¯†å¯†é’¥å¿…é¡»æ˜¯16ä½ï¼' : 'SM4 national encryption key must be 16 bits!');
                            return;
                        }
                        result = sm4Decrypt(text, key);
                        break;
                    case 'rc4':
                        result = rc4Decrypt(text, key);
                        break;
                    case 'xor':
                        result = xorEncryptDecrypt(text, key);
                        break;
                    case 'caesarPlus':
                        result = caesarPlusDecrypt(text, step);
                        break;
                    case 'charMove':
                        result = charMoveDecrypt(text, step);
                        break;
                    case 'base91':
                        result = base91Decode(text);
                        break;
                    case 'base64':
                        result = base64Decrypt(text);
                        break;
                    case 'base32':
                        result = base32Decode(text);
                        break;
                    case 'customMix':
                        result = customMixDecrypt(text, step, mixChars.value.trim());
                        break;
                }
                resultText.value = result;
            } catch (e) {
                alert((currentLang === 'zh' ? 'è§£å¯†å¤±è´¥ï¼š' : 'Decryption failed: ') + e.message);
            }
        }

        // æ¸…ç©ºåŠŸèƒ½
        function clearAll() {
            originText.value = '';
            resultText.value = '';
            aesKey.value = '';
            mixOffset.value = 5;
            mixChars.value = 'â˜…â– â—â–²â—†';
            encryptType.value = 'aes';
            filterTags.forEach(t => t.classList.remove('active'));
            filterTags[0].classList.add('active');
            const allOptions = encryptType.options;
            for (let i = 0; i < allOptions.length; i++) {
                allOptions[i].style.display = 'block';
            }
            if (helpModal.style.display === 'block') closeModal();
        }
    </script>
</body>

</html>
