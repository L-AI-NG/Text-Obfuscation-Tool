<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文本加密小工具</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/crypto-js/4.2.0/components/mode-cbc.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/crypto-js/4.2.0/components/pad-pkcs7.min.js"></script>
    <style>
        * {margin: 0;padding: 0;box-sizing: border-box;transition: all 0.3s ease;}
        :root {
            --bg: #121212;
            --text: #e0e0e0;
            --text-light: #9e9e9e;
            --card: #1e1e1e;
            --card-hover: #252525;
            --border: #333333;
            --border-hover: #444444;
            --primary: #64b5f6;
            --primary-hover: #42a5f5;
            --secondary: #757575;
            --secondary-hover: #9e9e9e;
            --tip-success: #1b5e20;
            --tip-success-text: #a5d6a7;
            --tip-error: #b71c1c;
            --tip-error-text: #ef9a9a;
            --disclaimer: #2d2d2d;
            --shadow: 0 2px 8px rgba(0,0,0,0.3);
            --radius: 8px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
        }
        body {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-lg) var(--spacing-md);
            font-family: 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }
        /* 头部区域优化 */
        .header {
            margin-bottom: var(--spacing-lg);
            text-align: center;
            position: relative;
        }
        .title {
            font-size: 26px;
            color: var(--primary);
            margin-bottom: var(--spacing-md);
            font-weight: 600;
        }
        .top-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--spacing-md);
            flex-wrap: wrap;
            margin-bottom: var(--spacing-md);
        }
        .lang-group {
            display: flex;
            gap: var(--spacing-sm);
            background: var(--card);
            padding: 4px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
        }
        .lang-btn {
            padding: 6px 14px;
            border: none;
            border-radius: calc(var(--radius) - 2px);
            background: transparent;
            color: var(--text-light);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        .lang-btn.active {
            background: var(--primary);
            color: white;
        }
        .lang-btn:hover:not(.active) {
            color: var(--text);
        }
        .help-btn {
            padding: 6px 14px;
            border: none;
            border-radius: var(--radius);
            background: var(--secondary);
            color: white;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .help-btn:hover {
            background: var(--secondary-hover);
        }
        /* 加密方式选择区 */
        .method-section {
            margin-bottom: var(--spacing-lg);
        }
        .section-title {
            font-size: 16px;
            color: var(--primary);
            margin-bottom: var(--spacing-sm);
            text-align: left;
            font-weight: 500;
        }
        .method-buttons {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
            background: var(--card);
            padding: var(--spacing-md);
            border-radius: var(--radius);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }
        .method-btn {
            flex: 1;
            min-width: 120px;
            padding: 12px var(--spacing-sm);
            border: none;
            border-radius: var(--radius);
            background: var(--secondary);
            color: white;
            cursor: pointer;
            font-size: 15px;
            transition: all 0.2s ease;
        }
        .method-btn.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(100, 181, 246, 0.2);
        }
        .method-btn:hover:not(.active) {
            background: var(--secondary-hover);
        }
        /* 参数配置区 */
        .params-section {
            margin-bottom: var(--spacing-lg);
        }
        .params-card {
            background: var(--card);
            padding: var(--spacing-md);
            border-radius: var(--radius);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            display: none;
        }
        .params-card.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .param-item {
            margin-bottom: var(--spacing-md);
        }
        .param-item:last-child {
            margin-bottom: 0;
        }
        .param-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            font-size: 14px;
        }
        .param-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 15px;
            background: var(--card);
            color: var(--text);
        }
        .param-input:focus {
            outline: none;
            border-color: var(--primary);
            border-width: 2px;
            background: var(--card-hover);
        }
        .param-desc {
            font-size: 12px;
            color: var(--text-light);
            margin-top: 4px;
        }
        /* 文本输入输出区 */
        .text-section {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }
        .text-card {
            background: var(--card);
            padding: var(--spacing-md);
            border-radius: var(--radius);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }
        .text-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-sm);
        }
        .text-card-title {
            font-size: 16px;
            font-weight: 500;
            color: var(--primary);
        }
        .text-input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            min-height: 150px;
            resize: vertical;
            font-family: inherit;
            font-size: 15px;
            background: var(--card);
            color: var(--text);
            margin-bottom: var(--spacing-sm);
        }
        .text-input:focus {
            outline: none;
            border-color: var(--primary);
            border-width: 2px;
            background: var(--card-hover);
        }
        .text-actions {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }
        .text-btn {
            padding: 8px 16px;
            border: none;
            border-radius: var(--radius);
            background: var(--secondary);
            color: white;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .text-btn.primary {
            background: var(--primary);
        }
        .text-btn:hover {
            background: var(--secondary-hover);
        }
        .text-btn.primary:hover {
            background: var(--primary-hover);
        }
        /* 主操作区 */
        .action-section {
            display: flex;
            justify-content: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }
        .main-btn {
            padding: 14px 32px;
            border: none;
            border-radius: var(--radius);
            background: var(--primary);
            color: white;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.2s ease;
            min-width: 150px;
        }
        .main-btn.secondary {
            background: var(--secondary);
        }
        .main-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(100, 181, 246, 0.2);
        }
        .main-btn.secondary:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        /* 免责声明区 */
        .disclaimer-section {
            margin-bottom: var(--spacing-lg);
        }
        .disclaimer {
            background: var(--disclaimer);
            border-left: 4px solid var(--primary);
            padding: var(--spacing-md);
            border-radius: 0 var(--radius) var(--radius) 0;
            font-size: 13px;
            line-height: 1.7;
            color: var(--text-light);
        }
        /* 提示框优化 */
        .copy-tip {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: var(--radius);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 999;
            background: var(--tip-success);
            color: var(--tip-success-text);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .copy-tip.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .copy-tip.error {
            background: var(--tip-error);
            color: var(--tip-error-text);
        }
        /* 弹窗优化 */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }
        .modal-content {
            background: var(--card);
            padding: var(--spacing-lg);
            border-radius: var(--radius);
            max-width: 550px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border);
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--border);
            padding-bottom: var(--spacing-sm);
        }
        .modal-title {
            font-size: 18px;
            color: var(--primary);
            font-weight: 600;
        }
        .modal-close {
            border: none;
            background: none;
            font-size: 22px;
            cursor: pointer;
            color: var(--secondary);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        .modal-close:hover {
            background: var(--disclaimer);
            color: var(--text);
        }
        .modal-section {
            margin-bottom: var(--spacing-md);
        }
        .modal-section h3 {
            font-size: 16px;
            margin-bottom: 8px;
            color: var(--primary);
        }
        .modal-section p {
            font-size: 14px;
            line-height: 1.6;
            color: var(--text);
            margin-bottom: 6px;
        }
        /* 响应式适配 */
        @media (max-width: 768px) {
            .title {
                font-size: 22px;
            }
            .method-btn {
                min-width: 100px;
                font-size: 14px;
                padding: 10px var(--spacing-sm);
            }
            .action-section {
                flex-direction: column;
            }
            .main-btn {
                width: 100%;
                min-width: auto;
            }
            .text-card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-sm);
            }
        }
        @media (max-width: 480px) {
            .top-controls {
                flex-direction: column;
                align-items: stretch;
            }
            .lang-group {
                width: 100%;
            }
            .help-btn {
                width: 100%;
                justify-content: center;
            }
            .method-buttons {
                flex-direction: column;
            }
            .method-btn {
                width: 100%;
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <!-- 头部区域 -->
    <div class="header">
        <h1 class="title" id="toolTitle">文本加密小工具</h1>
        <div class="top-controls">
            <div class="lang-group">
                <button class="lang-btn active" id="langZh">简体中文</button>
                <button class="lang-btn" id="langEn">English</button>
            </div>
            <button class="help-btn" id="helpBtn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                <span id="helpBtnText">使用说明</span>
            </button>
        </div>
    </div>

    <!-- 加密方式选择区 -->
    <div class="method-section">
        <h2 class="section-title" id="methodSectionTitle">选择加密方式</h2>
        <div class="method-buttons">
            <button class="method-btn active" data-method="aes" id="methodAes">高安全加密</button>
            <button class="method-btn" data-method="base64" id="methodBase64">Base64编码</button>
            <button class="method-btn" data-method="custom" id="methodCustom">自定义混淆</button>
        </div>
    </div>

    <!-- 参数配置区 -->
    <div class="params-section">
        <h2 class="section-title" id="paramsSectionTitle">参数配置</h2>
        
        <!-- 高安全加密参数 -->
        <div class="params-card active" id="aes-params">
            <div class="param-item">
                <label class="param-label" id="labelAesKey">加密密钥（任意长度）：</label>
                <input type="text" class="param-input" id="aesKey" data-placeholder-zh="请输入密钥（丢失后无法解密）" data-placeholder-en="Enter key (Cannot decrypt if lost)">
                <p class="param-desc" id="aesKeyDesc">密钥用于加密和解密，建议使用复杂组合并妥善保管</p>
            </div>
        </div>

        <!-- Base64参数（无） -->
        <div class="params-card" id="base64-params">
            <div class="param-item">
                <p class="param-desc" id="base64Desc">Base64编码无需密钥，直接加密/解密即可，适用于文本传输和简单混淆</p>
            </div>
        </div>

        <!-- 自定义混淆参数 -->
        <div class="params-card" id="custom-params">
            <div class="param-item">
                <label class="param-label" id="labelOffset">偏移步数（整数）：</label>
                <input type="number" class="param-input" id="mixOffset" value="5" min="1" max="50">
                <p class="param-desc" id="offsetDesc">控制字符偏移量，加密和解密需使用相同步数</p>
            </div>
            <div class="param-item">
                <label class="param-label" id="labelMixChars">混淆插入字符：</label>
                <input type="text" class="param-input" id="mixChars" value="★■●▲◆" data-placeholder-zh="如：★■●▲◆（自定义特殊字符）" data-placeholder-en="e.g.: ★■●▲◆ (Custom special characters)">
                <p class="param-desc" id="mixCharsDesc">加密时插入的混淆字符，解密需使用完全相同的字符集</p>
            </div>
        </div>
    </div>

    <!-- 文本输入输出区 -->
    <div class="text-section">
        <!-- 原始文本输入 -->
        <div class="text-card">
            <div class="text-card-header">
                <h3 class="text-card-title" id="originTextTitle">原始文本</h3>
                <div class="text-actions">
                    <label for="fileInput" class="text-btn" id="fileBtn">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        <span>导入TXT</span>
                    </label>
                    <input type="file" id="fileInput" class="file-input" accept=".txt" hidden>
                </div>
            </div>
            <textarea class="text-input" id="originText" data-placeholder-zh="请输入需要加密/解密的文本..." data-placeholder-en="Enter text to encrypt/decrypt..."></textarea>
        </div>

        <!-- 处理结果输出 -->
        <div class="text-card">
            <div class="text-card-header">
                <h3 class="text-card-title" id="resultTextTitle">处理结果</h3>
                <div class="text-actions">
                    <button class="text-btn" onclick="copyResult()" id="copyBtn">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2v-4a2 2 0 0 1 2-2h1"></path>
                        </svg>
                        <span id="copyBtnText">复制结果</span>
                    </button>
                    <button class="text-btn" onclick="exportResult()" id="exportBtn">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        <span id="exportBtnText">导出TXT</span>
                    </button>
                </div>
            </div>
            <textarea class="text-input" id="resultText" readonly data-placeholder-zh="处理后的结果将显示在这里..." data-placeholder-en="Processed result will be displayed here..."></textarea>
        </div>
    </div>

    <!-- 主操作区 -->
    <div class="action-section">
        <button class="main-btn" onclick="encryptText()" id="encryptBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M2 12h20"></path>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
            </svg>
            <span id="encryptBtnText">加密</span>
        </button>
        <button class="main-btn" onclick="decryptText()" id="decryptBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
            <span id="decryptBtnText">解密</span>
        </button>
        <button class="main-btn secondary" onclick="clearAll()" id="clearBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
            <span id="clearBtnText">清空</span>
        </button>
    </div>

    <!-- 免责声明区 -->
    <div class="disclaimer-section">
        <div class="disclaimer" id="disclaimerText">
            本工具为开源静态部署工具，所有操作均在本地浏览器完成，不会收集、存储或传输任何用户输入信息。用户需自行对输入信息的安全性、合法性及合规性负责，工具开发者不对任何因使用本工具导致的信息泄露、数据安全问题或法律风险承担责任。
        </div>
    </div>

    <!-- 提示框 -->
    <div class="copy-tip" id="copyTip">
        <!-- 动态切换图标 -->
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tip-icon" id="tipIcon">
            <polyline points="9 11 12 14 22 4"></polyline>
            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
        </svg>
        <span id="tipText">提示信息</span>
    </div>

    <!-- 帮助弹窗 -->
    <div class="modal" id="helpModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">使用说明</h2>
                <button class="modal-close" id="modalClose">×</button>
            </div>
            <div class="modal-section">
                <h3 id="modalH3_1">一、功能说明</h3>
                <p id="modalP1_1">1. 高安全加密：基于AES算法，任意长度密钥，适用于敏感数据加密，加密解密需相同密钥</p>
                <p id="modalP1_2">2. Base64编码：无密钥，仅用于文本混淆和跨平台传输，不具备加密安全性</p>
                <p id="modalP1_3">3. 自定义混淆：通过字符偏移+特殊字符插入实现双重混淆，解密需完全匹配参数</p>
            </div>
            <div class="modal-section">
                <h3 id="modalH3_2">二、使用步骤</h3>
                <p id="modalP2_1">1. 选择加密方式（点击顶部按钮）</p>
                <p id="modalP2_2">2. 填写对应参数（仅高安全加密和自定义混淆需要）</p>
                <p id="modalP2_3">3. 输入或导入原始文本（支持TXT文件批量导入）</p>
                <p id="modalP2_4">4. 点击加密/解密按钮，结果将显示在右侧输出区</p>
                <p id="modalP2_5">5. 可复制结果或导出为TXT文件保存</p>
            </div>
            <div class="modal-section">
                <h3 id="modalH3_3">三、注意事项</h3>
                <p id="modalP3_1">1. 高安全加密密钥请妥善保管，丢失后无法解密任何加密数据</p>
                <p id="modalP3_2">2. 自定义混淆解密时，偏移步数和混淆字符需与加密时完全一致</p>
                <p id="modalP3_3">3. 所有操作均在本地浏览器完成，数据不会上传至任何服务器</p>
                <p id="modalP3_4">4. 请勿用于加密非法信息，用户需自行承担法律责任</p>
            </div>
        </div>
    </div>

    <script>
        // ========== 多语言配置 ==========
        const langConfig = {
            zh: {
                toolTitle: "文本加密小工具",
                helpBtnText: "使用说明",
                methodSectionTitle: "选择加密方式",
                methodAes: "高安全加密",
                methodBase64: "Base64编码",
                methodCustom: "自定义混淆",
                paramsSectionTitle: "参数配置",
                labelAesKey: "加密密钥（任意长度）：",
                aesKeyDesc: "密钥用于加密和解密，建议使用复杂组合并妥善保管",
                base64Desc: "Base64编码无需密钥，直接加密/解密即可，适用于文本传输和简单混淆",
                labelOffset: "偏移步数（整数）：",
                offsetDesc: "控制字符偏移量，加密和解密需使用相同步数",
                labelMixChars: "混淆插入字符：",
                mixCharsDesc: "加密时插入的混淆字符，解密需使用完全相同的字符集",
                originTextTitle: "原始文本",
                fileBtn: "导入TXT",
                resultTextTitle: "处理结果",
                copyBtnText: "复制结果",
                exportBtnText: "导出TXT",
                encryptBtnText: "加密",
                decryptBtnText: "解密",
                clearBtnText: "清空",
                disclaimerText: "本工具为开源静态部署工具，所有操作均在本地浏览器完成，不会收集、存储或传输任何用户输入信息。用户需自行对输入信息的安全性、合法性及合规性负责，工具开发者不对任何因使用本工具导致的信息泄露、数据安全问题或法律风险承担责任。",
                tipCopySuccess: "复制成功！",
                tipCopyError: "暂无可复制内容！",
                tipExportSuccess: "导出成功！",
                tipExportError: "暂无可导出内容！",
                tipImportSuccess: "文件导入成功！",
                tipImportError: "仅支持TXT文件！",
                tipEncryptSuccess: "加密成功！",
                tipDecryptSuccess: "解密成功！",
                tipNoText: "请输入原始文本！",
                tipNoKey: "请输入加密密钥！",
                tipAesError: "密文格式错误！",
                tipAesKeyError: "密钥错误，解密失败！",
                tipBase64Error: "Base64格式错误！",
                tipCustomError: "非自定义混淆文本！",
                tipClear: "已清空所有内容！",
                modalTitle: "使用说明",
                modalH3_1: "一、功能说明",
                modalP1_1: "1. 高安全加密：基于AES算法，任意长度密钥，适用于敏感数据加密，加密解密需相同密钥",
                modalP1_2: "2. Base64编码：无密钥，仅用于文本混淆和跨平台传输，不具备加密安全性",
                modalP1_3: "3. 自定义混淆：通过字符偏移+特殊字符插入实现双重混淆，解密需完全匹配参数",
                modalH3_2: "二、使用步骤",
                modalP2_1: "1. 选择加密方式（点击顶部按钮）",
                modalP2_2: "2. 填写对应参数（仅高安全加密和自定义混淆需要）",
                modalP2_3: "3. 输入或导入原始文本（支持TXT文件批量导入）",
                modalP2_4: "4. 点击加密/解密按钮，结果将显示在右侧输出区",
                modalP2_5: "5. 可复制结果或导出为TXT文件保存",
                modalH3_3: "三、注意事项",
                modalP3_1: "1. 高安全加密密钥请妥善保管，丢失后无法解密任何加密数据",
                modalP3_2: "2. 自定义混淆解密时，偏移步数和混淆字符需与加密时完全一致",
                modalP3_3: "3. 所有操作均在本地浏览器完成，数据不会上传至任何服务器",
                modalP3_4: "4. 请勿用于加密非法信息，用户需自行承担法律责任"
            },
            en: {
                toolTitle: "Text Encryption Tool",
                helpBtnText: "User Guide",
                methodSectionTitle: "Select Encryption Method",
                methodAes: "High-Security Encryption",
                methodBase64: "Base64 Encoding",
                methodCustom: "Custom Obfuscation",
                paramsSectionTitle: "Parameter Configuration",
                labelAesKey: "Encryption Key (Any Length):",
                aesKeyDesc: "The key is used for encryption and decryption. It is recommended to use a complex combination and keep it safe",
                base64Desc: "Base64 encoding requires no key, encrypt/decrypt directly, suitable for text transmission and simple obfuscation",
                labelOffset: "Offset Steps (integer):",
                offsetDesc: "Control character offset, same steps required for encryption and decryption",
                labelMixChars: "Obfuscation Insert Characters:",
                mixCharsDesc: "Obfuscation characters inserted during encryption, exact same character set required for decryption",
                originTextTitle: "Original Text",
                fileBtn: "Import TXT",
                resultTextTitle: "Processing Result",
                copyBtnText: "Copy Result",
                exportBtnText: "Export TXT",
                encryptBtnText: "Encrypt",
                decryptBtnText: "Decrypt",
                clearBtnText: "Clear All",
                disclaimerText: "This tool is an open-source static deployment tool. All operations are completed locally in the browser, and no user input information is collected, stored, or transmitted. Users are solely responsible for the security, legality, and compliance of the input information. The tool developer shall not be liable for any information leakage, data security issues, or legal risks arising from the use of this tool.",
                tipCopySuccess: "Copy Success!",
                tipCopyError: "No content to copy!",
                tipExportSuccess: "Export Success!",
                tipExportError: "No content to export!",
                tipImportSuccess: "File imported successfully!",
                tipImportError: "Only TXT files are supported!",
                tipEncryptSuccess: "Encryption Success!",
                tipDecryptSuccess: "Decryption Success!",
                tipNoText: "Please enter original text!",
                tipNoKey: "Please enter encryption key!",
                tipAesError: "Ciphertext format error!",
                tipAesKeyError: "Wrong key, decryption failed!",
                tipBase64Error: "Base64 format error!",
                tipCustomError: "Not custom obfuscated text!",
                tipClear: "All content cleared!",
                modalTitle: "User Guide",
                modalH3_1: "1. Function Description",
                modalP1_1: "1. High-Security Encryption: Based on AES algorithm, any length key, suitable for sensitive data, same key required for decryption",
                modalP1_2: "2. Base64 Encoding: No key required, only for text obfuscation and cross-platform transmission, no encryption security",
                modalP1_3: "3. Custom Obfuscation: Double obfuscation via character offset + special character insertion, exact parameters required for decryption",
                modalH3_2: "2. Usage Steps",
                modalP2_1: "1. Select encryption method (click top buttons)",
                modalP2_2: "2. Fill in corresponding parameters (only for high-security encryption and custom obfuscation)",
                modalP2_3: "3. Enter or import original text (supports batch TXT import)",
                modalP2_4: "4. Click encrypt/decrypt button, result will be displayed in the right output area",
                modalP2_5: "5. Copy result or export as TXT file for saving",
                modalH3_3: "3. Notes",
                modalP3_1: "1. Keep the high-security encryption key properly, cannot decrypt any encrypted data if lost",
                modalP3_2: "2. For custom obfuscation decryption, offset steps and obfuscation characters must be consistent with encryption",
                modalP3_3: "3. All operations are completed locally in the browser, data will not be uploaded to any server",
                modalP3_4: "4. Do not use for encrypting illegal information, users shall bear legal responsibility"
            }
        };

        // DOM元素获取
        const getDom = id => document.getElementById(id);
        const originText = getDom('originText');
        const resultText = getDom('resultText');
        const aesKey = getDom('aesKey');
        const mixOffset = getDom('mixOffset');
        const mixChars = getDom('mixChars');
        const copyTip = getDom('copyTip');
        const tipText = getDom('tipText');
        const tipIcon = getDom('tipIcon'); // 新增：获取提示图标元素
        const methodBtns = document.querySelectorAll('.method-btn');
        const paramsCards = document.querySelectorAll('.params-card');
        const helpModal = getDom('helpModal');
        const helpBtn = getDom('helpBtn');
        const modalClose = getDom('modalClose');
        const fileInput = getDom('fileInput');
        const langBtns = document.querySelectorAll('.lang-btn');
        
        let currentMethod = 'aes';
        let currentLang = 'zh';

        // ========== 多语言切换逻辑 ==========
        function updateLang(lang) {
            currentLang = lang;
            const config = langConfig[lang];
            
            // 更新文本内容
            Object.keys(config).forEach(key => {
                const el = getDom(key);
                if (el) el.textContent = config[key];
            });
            
            // 更新输入框占位符
            [aesKey, mixChars, originText, resultText].forEach(el => {
                el.placeholder = el.getAttribute(`data-placeholder-${lang}`);
            });
            
            // 更新语言按钮状态
            langBtns.forEach(btn => {
                btn.classList.toggle('active', btn.id === `lang${lang === 'zh' ? 'Zh' : 'En'}`);
            });
        }

        // 语言按钮事件
        langBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const lang = btn.id === 'langZh' ? 'zh' : 'en';
                updateLang(lang);
            });
        });

        // ========== 加密方式切换逻辑 ==========
        methodBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // 更新按钮状态
                methodBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentMethod = btn.dataset.method;
                
                // 更新参数卡片显示
                paramsCards.forEach(card => {
                    card.classList.remove('active');
                });
                getDom(`${currentMethod}-params`).classList.add('active');
            });
        });

        // ========== TXT文件导入逻辑 ==========
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            if (!file.name.endsWith('.txt')) {
                showTip(langConfig[currentLang].tipImportError, false);
                fileInput.value = '';
                return;
            }
            const reader = new FileReader();
            reader.onload = (event) => {
                originText.value = event.target.result;
                showTip(langConfig[currentLang].tipImportSuccess, true);
                fileInput.value = '';
            };
            reader.onerror = () => {
                showTip(langConfig[currentLang].tipImportError, false);
                fileInput.value = '';
            };
            reader.readAsText(file, 'UTF-8');
        });

        // ========== 提示框逻辑（核心修改） ==========
        function showTip(text, isSuccess = true) {
            tipText.textContent = text;
            copyTip.className = `copy-tip ${isSuccess ? '' : 'error'} show`;
            
            // 根据成功/失败切换图标
            if (isSuccess) {
                // 成功图标：√
                tipIcon.innerHTML = `
                    <polyline points="9 11 12 14 22 4"></polyline>
                    <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                `;
            } else {
                // 失败图标：×
                tipIcon.innerHTML = `
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                `;
            }
            
            setTimeout(() => {
                copyTip.classList.remove('show');
            }, 3000);
        }

        // ========== 复制导出逻辑 ==========
        function copyResult() {
            const text = resultText.value.trim();
            if (!text) {
                showTip(langConfig[currentLang].tipCopyError, false);
                return;
            }
            navigator.clipboard.writeText(text).then(() => {
                showTip(langConfig[currentLang].tipCopySuccess);
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showTip(langConfig[currentLang].tipCopySuccess);
            });
        }

        function exportResult() {
            const text = resultText.value.trim();
            if (!text) {
                showTip(langConfig[currentLang].tipExportError, false);
                return;
            }
            const blob = new Blob([text], { type: 'text/plain; charset=utf-8' });
            const a = document.createElement('a');
            const date = new Date();
            const fileName = langConfig[currentLang].exportBtnText.includes('导出') 
                ? `加密结果_${date.getFullYear()}${(date.getMonth()+1).toString().padStart(2, '0')}${date.getDate().toString().padStart(2, '0')}.txt`
                : `Encryption_Result_${date.getFullYear()}${(date.getMonth()+1).toString().padStart(2, '0')}${date.getDate().toString().padStart(2, '0')}.txt`;
            a.download = fileName;
            a.href = URL.createObjectURL(blob);
            a.click();
            URL.revokeObjectURL(a.href);
            showTip(langConfig[currentLang].tipExportSuccess);
        }

        // ========== 清空逻辑 ==========
        function clearAll() {
            originText.value = '';
            resultText.value = '';
            aesKey.value = '';
            mixOffset.value = 5;
            mixChars.value = '★■●▲◆';
            showTip(langConfig[currentLang].tipClear);
        }

        // ========== 帮助弹窗逻辑 ==========
        helpBtn.addEventListener('click', () => {
            helpModal.style.display = 'flex';
        });

        modalClose.addEventListener('click', () => {
            helpModal.style.display = 'none';
        });

        helpModal.addEventListener('click', (e) => {
            if (e.target === helpModal) {
                helpModal.style.display = 'none';
            }
        });

        // ========== 加密解密核心逻辑 ==========
        function aesEncrypt(text, key) {
            const processedKey = CryptoJS.enc.Utf8.parse(key.padEnd(32, '0').slice(0, 32));
            const iv = CryptoJS.lib.WordArray.random(16);
            const encrypted = CryptoJS.AES.encrypt(text, processedKey, { 
                iv: iv, 
                mode: CryptoJS.mode.CBC, 
                padding: CryptoJS.pad.Pkcs7 
            });
            return iv.toString(CryptoJS.enc.Hex) + '|' + encrypted.ciphertext.toString(CryptoJS.enc.Hex);
        }

        function aesDecrypt(text, key) {
            const [ivHex, cipherHex] = text.split('|');
            if (!ivHex || !cipherHex) throw new Error(langConfig[currentLang].tipAesError);
            
            const processedKey = CryptoJS.enc.Utf8.parse(key.padEnd(32, '0').slice(0, 32));
            const iv = CryptoJS.enc.Hex.parse(ivHex);
            const ciphertext = CryptoJS.enc.Hex.parse(cipherHex);
            
            // 解密并验证结果
            const decrypted = CryptoJS.AES.decrypt({ ciphertext: ciphertext }, processedKey, { 
                iv: iv, 
                mode: CryptoJS.mode.CBC, 
                padding: CryptoJS.pad.Pkcs7 
            });
            
            const decryptedText = decrypted.toString(CryptoJS.enc.Utf8);
            
            // 验证解密结果是否有效（空字符串或乱码说明密钥错误）
            if (!decryptedText || /[\u0000-\u001F\u007F-\u009F]/.test(decryptedText)) {
                throw new Error(langConfig[currentLang].tipAesKeyError);
            }
            
            return decryptedText;
        }

        function base64Encrypt(text) {
            return btoa(encodeURIComponent(text));
        }

        function base64Decrypt(text) {
            try {
                return decodeURIComponent(atob(text));
            } catch (e) {
                throw new Error(langConfig[currentLang].tipBase64Error);
            }
        }

        function customMixEncrypt(text, offset, mixCharsStr) {
            const offsetNum = Number(offset) || 5;
            const mixCharsArr = mixCharsStr.split('');
            let offsetText = text.split('').map(char => 
                String.fromCharCode(char.charCodeAt(0) + offsetNum)
            ).join('');
            const insertInterval = 3;
            let mixedText = '';
            for (let i = 0; i < offsetText.length; i++) {
                mixedText += offsetText[i];
                if ((i + 1) % insertInterval === 0) {
                    mixedText += mixCharsArr[Math.floor(Math.random() * mixCharsArr.length)];
                }
            }
            return `[CUSTOM]${mixedText}[END]`;
        }

        function customMixDecrypt(text, offset, mixCharsStr) {
            if (!text.startsWith('[CUSTOM]') || !text.endsWith('[END]')) {
                throw new Error(langConfig[currentLang].tipCustomError);
            }
            const offsetNum = Number(offset) || 5;
            const mixCharsArr = mixCharsStr.split('');
            let pureText = text.slice(8, -5);
            pureText = pureText.split('').filter(char => !mixCharsArr.includes(char)).join('');
            return pureText.split('').map(char => 
                String.fromCharCode(char.charCodeAt(0) - offsetNum)
            ).join('');
        }

        // ========== 统一加密解密入口 ==========
        function encryptText() {
            const text = originText.value.trim();
            if (!text) {
                showTip(langConfig[currentLang].tipNoText, false);
                return;
            }

            try {
                let result = '';
                switch (currentMethod) {
                    case 'aes':
                        const key = aesKey.value.trim();
                        if (!key) {
                            showTip(langConfig[currentLang].tipNoKey, false);
                            return;
                        }
                        result = aesEncrypt(text, key);
                        break;
                    case 'base64':
                        result = base64Encrypt(text);
                        break;
                    case 'custom':
                        const offset = mixOffset.value;
                        const chars = mixChars.value.trim() || '★■●▲◆';
                        result = customMixEncrypt(text, offset, chars);
                        break;
                }
                resultText.value = result;
                showTip(langConfig[currentLang].tipEncryptSuccess);
            } catch (e) {
                showTip(`${langConfig[currentLang].tipEncryptSuccess.replace('成功', '失败').replace('Success', 'Failed')}: ${e.message}`, false);
            }
        }

        function decryptText() {
            const text = originText.value.trim();
            if (!text) {
                showTip(langConfig[currentLang].tipNoText, false);
                return;
            }

            try {
                let result = '';
                switch (currentMethod) {
                    case 'aes':
                        const key = aesKey.value.trim();
                        if (!key) {
                            showTip(langConfig[currentLang].tipNoKey, false);
                            return;
                        }
                        result = aesDecrypt(text, key);
                        break;
                    case 'base64':
                        result = base64Decrypt(text);
                        break;
                    case 'custom':
                        const offset = mixOffset.value;
                        const chars = mixChars.value.trim() || '★■●▲◆';
                        result = customMixDecrypt(text, offset, chars);
                        break;
                }
                // 只有解密结果有效时才显示成功
                if (result.trim()) {
                    resultText.value = result;
                    showTip(langConfig[currentLang].tipDecryptSuccess);
                } else {
                    throw new Error(langConfig[currentLang].tipAesKeyError);
                }
            } catch (e) {
                resultText.value = ''; // 清空错误结果
                showTip(`${langConfig[currentLang].tipDecryptSuccess.replace('成功', '失败').replace('Success', 'Failed')}: ${e.message}`, false);
            }
        }

        // 初始化中文
        updateLang('zh');
    </script>
</body>
</html>